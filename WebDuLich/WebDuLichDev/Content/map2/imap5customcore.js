(function(){if(!window.imap5custom){window.imap5custom={};var a=window.imap5custom;a.div=[];a.background=[];a.foreground=[];a.usermap=[];a.map=[];a.mode=[];a.svg=[];a.g=[];a.svgcoord=[];a.zoom=[];a.zoomcontrol=[];a.panhome=[];a.zoomin=[];a.zoomout=[];a.selected=[];a.infobox=[];a.coords=[];a.selectedOverlay=[];a.selectedVerticesObj=[];a.marker=[];a.maplabel=[];a.mappath=[];a.mappoly=[];a.maprect=[];a.mapcurve=[];a.maplegend=[];a.mapcircle=[];a.path=[];a.poly=[];a.rect=[];a.curve=[];a.circle=[];a.center=
[];a.categorylegend=[];a.maptitle=[];a.base=[];a.precision=6;a.factor=[];a.setMode=function(b){a.mode[b.usermap]=b.mode;if("edit"==a.mode[b.usermap])for(var f in a.maplabel[b.usermap])a.maplabel[b.usermap].hasOwnProperty(f)&&(a.maplabel[b.usermap][f].getElementsByTagName("text")[0].style.pointerEvents="auto");else for(f in a.maplabel[b.usermap])a.maplabel[b.usermap].hasOwnProperty(f)&&(a.maplabel[b.usermap][f].getElementsByTagName("text")[0].style.pointerEvents="none");B(b)};a.setCategoryLegend=function(b){var f=
"undefined"==typeof a.usermap[b.usermap].map.categorylegend?!1:a.usermap[b.usermap].map.categorylegend.enable;a.usermap[b.usermap].map.categorylegend=b.categorylegend;a.usermap[b.usermap].map.categorylegend.enable?f?(a.categorylegend[b.usermap].setOptions(b.categorylegend),a.categorylegend[b.usermap].drawCategoryLegend(),a.updateCategoryLegend(b)):a.categorylegend[b.usermap]=new I(b,a.usermap[b.usermap].map.categorylegend):f&&a.categorylegend[b.usermap].remove();B(b)};a.setMapTitle=function(b){a.usermap[b.usermap].map.maptitle=
b.maptitle;"undefined"!==typeof a.maptitle[b.usermap]&&null!==a.maptitle[b.usermap]?(a.maptitle[b.usermap].setOptions(b.maptitle),a.maptitle[b.usermap].drawMapTitle()):a.maptitle[b.usermap]=new J(b,b.maptitle)};a.setZoomSetting=function(b){for(var f in b.zoom_setting)b.zoom_setting.hasOwnProperty(f)&&(a.usermap[b.usermap].map.zoom_setting[f]=b.zoom_setting[f]);a.panhome[b.usermap].style.visibility="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.homeControl?a.usermap[b.usermap].map.zoom_setting.homeControl?
"visible":"hidden":"visible";a.zoomin[b.usermap].style.visibility="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.zoomControl?a.usermap[b.usermap].map.zoom_setting.zoomControl?"visible":"hidden":"visible";a.zoomout[b.usermap].style.visibility="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.zoomControl?a.usermap[b.usermap].map.zoom_setting.zoomControl?"visible":"hidden":"visible"};a.setMarkers=function(b){for(var f in b.marker)b.marker.hasOwnProperty(f)&&(a.usermap[b.usermap].map.marker[f]=
b.marker[f],"undefined"!==typeof a.marker[b.usermap][f]&&null!==a.marker[b.usermap][f]?(a.marker[b.usermap][f].setOptions(b.marker[f]),a.marker[b.usermap][f].drawMarker()):a.marker[b.usermap][f]=new K(b,f,b.marker[f]),a.marker[b.usermap][f].toggleCategoryLegend())};a.delMarkers=function(b){a.marker[b.usermap][b.id].remove()};a.setMapLabels=function(b){for(var f in b.maplabel)b.maplabel.hasOwnProperty(f)&&(a.usermap[b.usermap].map.maplabel[f]=b.maplabel[f],"undefined"!==typeof a.maplabel[b.usermap][f]&&
null!==a.maplabel[b.usermap][f]?(a.maplabel[b.usermap][f].setOptions(b.maplabel[f]),a.maplabel[b.usermap][f].drawMapLabel()):a.maplabel[b.usermap][f]=new L(b,f,b.maplabel[f]),a.maplabel[b.usermap][f].toggleCategoryLegend())};a.delMapLabels=function(b){a.maplabel[b.usermap][b.id].remove()};a.setMapPaths=function(b){for(var f in b.mappath)b.mappath.hasOwnProperty(f)&&(a.usermap[b.usermap].map.mappath[f]=b.mappath[f],"undefined"!==typeof a.mappath[b.usermap][f]&&null!==a.mappath[b.usermap][f]?(a.mappath[b.usermap][f].setOptions(b.mappath[f]),
a.mappath[b.usermap][f].drawMapPath()):a.mappath[b.usermap][f]=new C(b,f,b.mappath[f]),a.mappath[b.usermap][f].toggleCategoryLegend())};a.delMapPaths=function(b){a.selectedVerticesObj[b.usermap]==a.mappath[b.usermap][b.id]&&(a.selectedVerticesObj[b.usermap]=null);a.mappath[b.usermap][b.id].remove()};a.selectMapPaths=function(b){a.mappath[b.usermap][b.id].createVertices()};a.setMapPolys=function(b){for(var f in b.mappoly)b.mappoly.hasOwnProperty(f)&&(a.usermap[b.usermap].map.mappoly[f]=b.mappoly[f],
"undefined"!==typeof a.mappoly[b.usermap][f]&&null!==a.mappoly[b.usermap][f]?(a.mappoly[b.usermap][f].setOptions(b.mappoly[f]),a.mappoly[b.usermap][f].drawMapPoly()):a.mappoly[b.usermap][f]=new D(b,f,b.mappoly[f]),a.mappoly[b.usermap][f].toggleCategoryLegend())};a.delMapPolys=function(b){a.selectedVerticesObj[b.usermap]==a.mappoly[b.usermap][b.id]&&(a.selectedVerticesObj[b.usermap]=null);a.mappoly[b.usermap][b.id].remove()};a.selectMapPolys=function(b){a.mappoly[b.usermap][b.id].createVertices()};
a.setMapCircles=function(b){for(var f in b.mapcircle)b.mapcircle.hasOwnProperty(f)&&(a.usermap[b.usermap].map.mapcircle[f]=b.mapcircle[f],"undefined"!==typeof a.mapcircle[b.usermap][f]&&null!==a.mapcircle[b.usermap][f]?(a.mapcircle[b.usermap][f].setOptions(b.mapcircle[f]),a.mapcircle[b.usermap][f].drawMapCircle()):a.mapcircle[b.usermap][f]=new E(b,f,b.mapcircle[f]),a.mapcircle[b.usermap][f].toggleCategoryLegend())};a.delMapCircles=function(b){a.selectedVerticesObj[b.usermap]==a.mapcircle[b.usermap][b.id]&&
(a.selectedVerticesObj[b.usermap]=null);a.mapcircle[b.usermap][b.id].remove()};a.selectMapCircles=function(b){a.mapcircle[b.usermap][b.id].createVertices()};a.setMapRects=function(b){for(var f in b.maprect)b.maprect.hasOwnProperty(f)&&(a.usermap[b.usermap].map.maprect[f]=b.maprect[f],"undefined"!==typeof a.maprect[b.usermap][f]&&null!==a.maprect[b.usermap][f]?(a.maprect[b.usermap][f].setOptions(b.maprect[f]),a.maprect[b.usermap][f].drawMapRect()):a.maprect[b.usermap][f]=new F(b,f,b.maprect[f]),a.maprect[b.usermap][f].toggleCategoryLegend())};
a.delMapRects=function(b){a.selectedVerticesObj[b.usermap]==a.maprect[b.usermap][b.id]&&(a.selectedVerticesObj[b.usermap]=null);a.maprect[b.usermap][b.id].remove()};a.selectMapRects=function(b){a.maprect[b.usermap][b.id].createVertices()};a.setMapCurves=function(b){for(var f in b.mapcurve)b.mapcurve.hasOwnProperty(f)&&(a.usermap[b.usermap].map.mapcurve[f]=b.mapcurve[f],"undefined"!==typeof a.mapcurve[b.usermap][f]&&null!==a.mapcurve[b.usermap][f]?(a.mapcurve[b.usermap][f].setOptions(b.mapcurve[f]),
a.mapcurve[b.usermap][f].drawMapCurve()):a.mapcurve[b.usermap][f]=new G(b,f,b.mapcurve[f]),a.mapcurve[b.usermap][f].toggleCategoryLegend())};a.delMapCurves=function(b){a.selectedVerticesObj[b.usermap]==a.mapcurve[b.usermap][b.id]&&(a.selectedVerticesObj[b.usermap]=null);a.mapcurve[b.usermap][b.id].remove()};a.selectMapCurves=function(b){a.mapcurve[b.usermap][b.id].createVertices()};a.setMapLegends=function(b){for(var f in b.maplegend)b.maplegend.hasOwnProperty(f)&&(a.usermap[b.usermap].map.maplegend[f]=
b.maplegend[f],"undefined"!==typeof a.maplegend[b.usermap][f]&&null!==a.maplegend[b.usermap][f]?(a.maplegend[b.usermap][f].setOptions(b.maplegend[f]),a.maplegend[b.usermap][f].drawMapLegend()):a.maplegend[b.usermap][f]=new M(b,f,b.maplegend[f]),a.maplegend[b.usermap][f].toggleCategoryLegend())};a.delMapLegends=function(b){a.maplegend[b.usermap][b.id].remove()};a.initUserMap=function(b){a.usermap[b.id]=b};a.initMap=function(b){a.map[b.id]=b};a.init=function(b){b.base||(b.base="");if(b.usermap&&(a.touchdevices=
"ontouchstart"in document.documentElement,a.mode[b.usermap]="normal",a.selected[b.usermap]=[],a.infobox[b.usermap]=[],a.coords[b.usermap]=[],a.selectedOverlay[b.usermap]=null,a.selectedVerticesObj[b.usermap]=null,a.marker[b.usermap]=[],a.maplabel[b.usermap]=[],a.mappath[b.usermap]=[],a.mappoly[b.usermap]=[],a.maprect[b.usermap]=[],a.mapcurve[b.usermap]=[],a.maplegend[b.usermap]=[],a.mapcircle[b.usermap]=[],a.path[b.usermap]=[],a.poly[b.usermap]=[],a.rect[b.usermap]=[],a.curve[b.usermap]=[],a.circle[b.usermap]=
[],a.categorylegend[b.usermap]={},a.maptitle[b.usermap]={},a.base[b.usermap]=b.base,a.factor[b.usermap]=1,document.writeln("\x3c!--[if lt IE 9]>"),document.writeln("<div>You can only view this map using Internet Explorer 9 or above, please upgrade or use other modern browsers like chrome, firefox or safari</div>"),document.writeln("<![endif]--\x3e"),document.writeln('<div id="imap5custom_'+b.usermap+'"></div>'),a.div[b.usermap]=document.getElementById("imap5custom_"+b.usermap),b.local)){a.local=!0;
var f=document.createElement("script");f.type="application/javascript";f.src=b.base+"imap5customusermap_"+b.usermap+".js?"+Math.random(1E5);f.onerror=function(){};f.onload=function(){T(b)};document.body.appendChild(f)}};a.updateCategoryLegend=function(a){B(a)};var r=function(b,f,k){var c;document.getElementById("imap5custom_"+b.usermap+"_hint")?c=document.getElementById("imap5custom_"+b.usermap+"_hint"):(c=document.createElement("div"),c.id="imap5custom_"+b.usermap+"_hint",a.div[b.usermap].appendChild(c));
c.style.backgroundColor="#FFFF88";c.style.pointerEvents="none";c.style.position="fixed";c.style.padding="2px";c.style.margin="5px";c.style.border="1px solid gray";c.style.borderRadius="5px";c.style.top=f.clientY+10+"px";c.style.left=f.clientX+10+"px";c.style.font="12px Arial";c.style.display="block";c.innerHTML=k},v=function(a){divhint=document.getElementById("imap5custom_"+a.usermap+"_hint");divhint.style.display="none"},w=function(a){return"#"==a.charAt(0)?a.substring(1,7):a},k=function(a,f){var k=
Math.pow(10,f);return Math.round(a*k)/k},H=function(a,f){var k=f.x-a.x,c=f.y-a.y;return Math.sqrt(k*k+c*c)},x=function(a,f){for(var k=f*Math.pow(1/1.5,4),c=-1,g=1;20>g;g++)if(0.1>Math.abs(a-k*Math.pow(1.5,g))){c=g+1;break}return c},B=function(b){for(var f in a.usermap[b.usermap].map.mappoly)a.usermap[b.usermap].map.mappoly.hasOwnProperty(f)&&a.mappoly[b.usermap][f].toggleCategory();for(f in a.usermap[b.usermap].map.mapcircle)a.usermap[b.usermap].map.mapcircle.hasOwnProperty(f)&&a.mapcircle[b.usermap][f].toggleCategory();
for(f in a.usermap[b.usermap].map.maprect)a.usermap[b.usermap].map.maprect.hasOwnProperty(f)&&a.maprect[b.usermap][f].toggleCategory();for(f in a.usermap[b.usermap].map.mappath)a.usermap[b.usermap].map.mappath.hasOwnProperty(f)&&a.mappath[b.usermap][f].toggleCategory();for(f in a.usermap[b.usermap].map.mapcurve)a.usermap[b.usermap].map.mapcurve.hasOwnProperty(f)&&a.mapcurve[b.usermap][f].toggleCategory();for(f in a.usermap[b.usermap].map.maplabel)a.usermap[b.usermap].map.maplabel.hasOwnProperty(f)&&
a.maplabel[b.usermap][f].toggleCategory();for(f in a.usermap[b.usermap].map.marker)a.usermap[b.usermap].map.marker.hasOwnProperty(f)&&a.marker[b.usermap][f].toggleCategory();for(f in a.usermap[b.usermap].map.maplegend)a.usermap[b.usermap].map.maplegend.hasOwnProperty(f)&&a.maplegend[b.usermap][f].toggleCategory()},p=function(a){return document.createElementNS("http://www.w3.org/2000/svg",a)},T=function(b){var f=a.usermap[b.usermap].map.id,h=a.usermap[b.usermap].map.y,c=a.usermap[b.usermap].map.x,
g=a.usermap[b.usermap].map.zoom;a.zoom[b.usermap]={};a.zoom[b.usermap].initzoom="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.init?k(a.usermap[b.usermap].map.zoom_setting.init.zoom,a.precision):k(g,a.precision);a.zoom[b.usermap].initlat="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.init?k(a.usermap[b.usermap].map.zoom_setting.init.y,a.precision):k(h,a.precision);a.zoom[b.usermap].initlng="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.init?k(a.usermap[b.usermap].map.zoom_setting.init.x,
a.precision):k(c,a.precision);"undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.editing?(a.zoom[b.usermap].loadeditingsetting=!0,a.zoom[b.usermap].currentzoom=k(a.usermap[b.usermap].map.zoom_setting.editing.zoom,a.precision),a.zoom[b.usermap].currentx=k(a.usermap[b.usermap].map.zoom_setting.editing.x,a.precision),a.zoom[b.usermap].currenty=k(a.usermap[b.usermap].map.zoom_setting.editing.y,a.precision)):(a.zoom[b.usermap].loadeditingsetting=!1,a.zoom[b.usermap].currentzoom=k(g,a.precision),
a.zoom[b.usermap].currentlat=k(h,a.precision),a.zoom[b.usermap].currentlng=k(c,a.precision));a.zoom[b.usermap].currentzoomlevel=x(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom);a.div[b.usermap].style.width=a.usermap[b.usermap].div.style.width;a.div[b.usermap].style.height=a.usermap[b.usermap].div.style.height;a.div[b.usermap].style.position="relative";if(!a.touchdevices&&(a.div[b.usermap].onmousemove=function(d){if(null!=a.selectedOverlay[b.usermap])a.selectedOverlay[b.usermap].onmousemove(d);
"marker"==a.mode[b.usermap]&&(this.style.cursor="pointer",r(b,d,"Click to add a marker"));"maplabel"==a.mode[b.usermap]&&(this.style.cursor="pointer",r(b,d,"Click to add a label"));if("mappath"==a.mode[b.usermap])if("undefined"!=typeof a.path[b.usermap][1]&&null!==a.path[b.usermap][1]){if("undefined"!=typeof a.coords[b.usermap]&&0<a.coords[b.usermap].length){this.style.cursor="pointer";r(b,d,"Right Click to end a path");var e=a.svgcoord[b.usermap];e.x=d.clientX;e.y=d.clientY;e=s(e,a.g[b.usermap]);
e.x/=a.map[f].precision/a.factor[b.usermap];e.y/=a.map[f].precision/a.factor[b.usermap];var c=e.x,e=e.y;a.path[b.usermap][1]._movingpoints=e+","+c;a.path[b.usermap][1].drawMapPath()}}else this.style.cursor="pointer",r(b,d,"Click to start a path");"mappoly"==a.mode[b.usermap]&&("undefined"!=typeof a.poly[b.usermap][1]&&null!==a.poly[b.usermap][1]?"undefined"!=typeof a.coords[b.usermap]&&0<a.coords[b.usermap].length&&(this.style.cursor="pointer",1<a.coords[b.usermap].length&&r(b,d,"Right Click to end a polygon"),
e=a.svgcoord[b.usermap],e.x=d.clientX,e.y=d.clientY,e=s(e,a.g[b.usermap]),e.x/=a.map[f].precision/a.factor[b.usermap],e.y/=a.map[f].precision/a.factor[b.usermap],c=e.x,e=e.y,a.poly[b.usermap][1]._movingpoints=e+","+c,a.poly[b.usermap][1].drawMapPoly()):(this.style.cursor="pointer",r(b,d,"Click to start a polygon")));"mapcircle"==a.mode[b.usermap]&&("undefined"!=typeof a.circle[b.usermap][1]&&null!==a.circle[b.usermap][1]?"undefined"!=typeof a.coords[b.usermap]&&1==a.coords[b.usermap].length&&(this.style.cursor=
"pointer",r(b,d,"Right Click to end a circle"),e=a.svgcoord[b.usermap],e.x=d.clientX,e.y=d.clientY,e=s(e,a.g[b.usermap]),e.x/=a.map[f].precision/a.factor[b.usermap],e.y/=a.map[f].precision/a.factor[b.usermap],c=e.x,e=e.y,a.circle[b.usermap][1]._movingpoints=e+","+c,a.circle[b.usermap][1].drawMapCircle()):(this.style.cursor="pointer",r(b,d,"Click to start a circle")));"maprect"==a.mode[b.usermap]&&("undefined"!=typeof a.rect[b.usermap][1]&&null!==a.rect[b.usermap][1]?"undefined"!=typeof a.coords[b.usermap]&&
1==a.coords[b.usermap].length&&(this.style.cursor="pointer",r(b,d,"Right Click to end a rectangle"),e=a.svgcoord[b.usermap],e.x=d.clientX,e.y=d.clientY,e=s(e,a.g[b.usermap]),e.x/=a.map[f].precision/a.factor[b.usermap],e.y/=a.map[f].precision/a.factor[b.usermap],c=e.x,e=e.y,a.rect[b.usermap][1]._movingpoints=e+","+c,a.rect[b.usermap][1].drawMapRect()):(this.style.cursor="pointer",r(b,d,"Click to start a rectangle")));"mapcurve"==a.mode[b.usermap]&&("undefined"!=typeof a.curve[b.usermap][1]&&null!==
a.curve[b.usermap][1]?"undefined"!=typeof a.coords[b.usermap]&&0<a.coords[b.usermap].length&&(this.style.cursor="pointer",1<a.coords[b.usermap].length?r(b,d,"Right Click to confirm the curvature"):r(b,d,"Click to define the end point of a curve"),e=a.svgcoord[b.usermap],e.x=d.clientX,e.y=d.clientY,e=s(e,a.g[b.usermap]),e.x/=a.map[f].precision/a.factor[b.usermap],e.y/=a.map[f].precision/a.factor[b.usermap],c=e.x,e=e.y,a.curve[b.usermap][1]._movingpoints=e+","+c,a.curve[b.usermap][1].drawMapCurve()):
(this.style.cursor="pointer",r(b,d,"Click to define the starting point of a curve")));d.preventDefault&&d.preventDefault();a.usermap[b.usermap].map.zoom_setting.draggable&&(this._mousedown&&(10<Math.abs(d.pageX-this._mousepositionx)||10<Math.abs(d.pageY-this._mousepositiony)))&&(this._mapdragged=!0,c=(this._mousepositionx-d.pageX)/a.zoom[b.usermap].currentzoom,e=(this._mousepositiony-d.pageY)/a.zoom[b.usermap].currentzoom,this._mousepositionx=d.pageX,this._mousepositiony=d.pageY,a.zoom[b.usermap].currentx=
k(a.zoom[b.usermap].currentx+c,a.precision),a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty-e,a.precision),t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx))},a.div[b.usermap].onmousedown=function(a){a.preventDefault&&a.preventDefault();this._mousepositionx=a.pageX;this._mousepositiony=a.pageY;this._mousedown=!0;this._mapdragged=!1},a.div[b.usermap].onmouseup=function(a){a.preventDefault&&a.preventDefault();this._mousedown=!1;this._mousepositiony=this._mousepositionx=
0},a.div[b.usermap].onmousewheel=function(d){d.preventDefault&&d.preventDefault();if(a.usermap[b.usermap].map.zoom_setting.mouseWheel){a.zoom[b.usermap].prevzoom=a.zoom[b.usermap].currentzoom;d||(d=window.event);var e=x(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom);d.wheelDelta&&(0<d.wheelDelta?20>e&&(a.zoom[b.usermap].currentzoom=k(1.5*a.zoom[b.usermap].currentzoom,a.precision)):1<e&&(a.zoom[b.usermap].currentzoom=k(a.zoom[b.usermap].currentzoom/1.5,a.precision)));var c=a.svgcoord[b.usermap];
c.x=d.clientX;c.y=d.clientY;for(var c=s(c,a.g[b.usermap]),g=this,n=0,h=0;g;)n+=g.offsetLeft,h+=g.offsetTop,g=g.offsetParent;c.x/=a.map[f].precision/a.factor[b.usermap];c.y/=a.map[f].precision/a.factor[b.usermap];0<d.wheelDelta?20>e&&(a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx-0.5*((parseFloat(this.style.width)/2-(d.pageX-n))/a.zoom[b.usermap].currentzoom),a.precision),a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty+0.5*((parseFloat(this.style.height)/2-(d.pageY-h))/a.zoom[b.usermap].currentzoom),
a.precision),t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx)):1<e&&(a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx+(parseFloat(this.style.width)/2-(d.pageX-n))/a.zoom[b.usermap].currentzoom*(1-1/1.5),a.precision),a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty-(parseFloat(this.style.height)/2-(d.pageY-h))/a.zoom[b.usermap].currentzoom*(1-1/1.5),a.precision),t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx))}},
a.div[b.usermap].addEventListener)){a.setMouseWheelEvent=function(a){d(a)};var d=function(d){d.preventDefault&&d.preventDefault();if(a.usermap[b.usermap].map.zoom_setting.mouseWheel){a.zoom[b.usermap].prevzoom=a.zoom[b.usermap].currentzoom;d||(d=window.event);var e=x(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom);d.detail&&(0>d.detail?20>e&&(a.zoom[b.usermap].currentzoom=k(1.5*a.zoom[b.usermap].currentzoom,a.precision)):1<e&&(a.zoom[b.usermap].currentzoom=k(a.zoom[b.usermap].currentzoom/
1.5,a.precision)));var c=a.svgcoord[b.usermap];c.x=d.pageX;c.y=d.pageY;for(var c=s(c,a.g[b.usermap]),g=this,n=0,h=0;g;)n+=g.offsetLeft,h+=g.offsetTop,g=g.offsetParent;c.x/=a.map[f].precision/a.factor[b.usermap];c.y/=a.map[f].precision/a.factor[b.usermap];0>d.detail?20>e&&(a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx-0.5*((parseInt(this.style.width)/2-(d.pageX-n))/a.zoom[b.usermap].currentzoom),a.precision),a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty+0.5*((parseInt(this.style.height)/
2-(d.pageY-h))/a.zoom[b.usermap].currentzoom),a.precision),t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx)):1<e&&(a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx+(parseInt(this.style.width)/2-(d.pageX-n))/a.zoom[b.usermap].currentzoom*(1-1/1.5),a.precision),a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty-(parseInt(this.style.height)/2-(d.pageY-h))/a.zoom[b.usermap].currentzoom*(1-1/1.5),a.precision),t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,
a.zoom[b.usermap].currentx))}};a.div[b.usermap].addEventListener("DOMMouseScroll",d,!1)}a.touchdevices||(a.div[b.usermap].oncontextmenu=function(d){if("mappath"==a.mode[b.usermap]){if(0<a.coords[b.usermap].length){var e=a.svgcoord[b.usermap];e.x=d.clientX;e.y=d.clientY;e=s(e,a.g[b.usermap]);e.x/=a.map[f].precision/a.factor[b.usermap];e.y/=a.map[f].precision/a.factor[b.usermap];d=e.x;e=e.y;a.coords[b.usermap].push(k(e,a.precision)+","+k(d,a.precision));a.path[b.usermap][1]._movingpoints="";a.path[b.usermap][1].drawMapPath();
d="";for(e=0;e<a.coords[b.usermap].length;e++)""!=d&&(d+=" "),d+=a.coords[b.usermap][e];var e=0,c;for(c in a.mappath[b.usermap])a.mappath[b.usermap].hasOwnProperty(c)&&"undefined"!==typeof a.mappath[b.usermap][c]&&null!==a.mappath[b.usermap][c]&&a.mappath[b.usermap][c]._id>e&&(e=Number(a.mappath[b.usermap][c]._id));c={event:"newmappath",object:"mappath"};c.points=d;c.id=e+1;window.console&&console.log(JSON.stringify(c));a.coords[b.usermap].length=0;a.g[b.usermap].removeChild(a.path[b.usermap][1]);
a.path[b.usermap][1]=null}return!1}if("mappoly"==a.mode[b.usermap]){if(1<a.coords[b.usermap].length){e=a.svgcoord[b.usermap];e.x=d.clientX;e.y=d.clientY;e=s(e,a.g[b.usermap]);e.x/=a.map[f].precision/a.factor[b.usermap];e.y/=a.map[f].precision/a.factor[b.usermap];d=e.x;e=e.y;a.coords[b.usermap].push(k(e,a.precision)+","+k(d,a.precision));a.poly[b.usermap][1]._movingpoints="";a.poly[b.usermap][1].drawMapPoly();d="";for(e=0;e<a.coords[b.usermap].length;e++)""!=d&&(d+=" "),d+=a.coords[b.usermap][e];e=
0;for(c in a.mappoly[b.usermap])a.mappoly[b.usermap].hasOwnProperty(c)&&"undefined"!==typeof a.mappoly[b.usermap][c]&&null!==a.mappoly[b.usermap][c]&&a.mappoly[b.usermap][c]._id>e&&(e=Number(a.mappoly[b.usermap][c]._id));e+=1;c={event:"newmappoly",object:"mappoly"};c.points=d;c.id=e;window.console&&console.log(JSON.stringify(c));a.coords[b.usermap].length=0;a.g[b.usermap].removeChild(a.poly[b.usermap][1]);a.poly[b.usermap][1]=null}return!1}if("mapcircle"==a.mode[b.usermap]){if(1==a.coords[b.usermap].length){e=
a.svgcoord[b.usermap];e.x=d.clientX;e.y=d.clientY;e=s(e,a.g[b.usermap]);e.x/=a.map[f].precision/a.factor[b.usermap];e.y/=a.map[f].precision/a.factor[b.usermap];d=e.x;e=e.y;a.coords[b.usermap].push(k(e,a.precision)+","+k(d,a.precision));a.circle[b.usermap][1]._movingpoints="";a.circle[b.usermap][1].drawMapCircle();d="";for(e=0;e<a.coords[b.usermap].length;e++)""!=d&&(d+=" "),d+=a.coords[b.usermap][e];e=0;for(c in a.mapcircle[b.usermap])a.mapcircle[b.usermap].hasOwnProperty(c)&&"undefined"!==typeof a.mapcircle[b.usermap][c]&&
null!==a.mapcircle[b.usermap][c]&&a.mapcircle[b.usermap][c]._id>e&&(e=Number(a.mapcircle[b.usermap][c]._id));e+=1;c={event:"newmapcircle",object:"mapcircle"};c.points=d;c.id=e;window.console&&console.log(JSON.stringify(c));a.coords[b.usermap].length=0;a.g[b.usermap].removeChild(a.circle[b.usermap][1]);a.circle[b.usermap][1]=null}return!1}if("maprect"==a.mode[b.usermap]){if(1==a.coords[b.usermap].length){e=a.svgcoord[b.usermap];e.x=d.clientX;e.y=d.clientY;e=s(e,a.g[b.usermap]);e.x/=a.map[f].precision/
a.factor[b.usermap];e.y/=a.map[f].precision/a.factor[b.usermap];d=e.x;var e=e.y,g=a.coords[b.usermap][0].split(",")[0],n=a.coords[b.usermap][0].split(",")[1];a.coords[b.usermap].push(k(g,a.precision)+","+k(d,a.precision));a.coords[b.usermap].push(k(e,a.precision)+","+k(d,a.precision));a.coords[b.usermap].push(k(e,a.precision)+","+k(n,a.precision));a.rect[b.usermap][1]._movingpoints="";a.rect[b.usermap][1].drawMapRect();d="";for(e=0;e<a.coords[b.usermap].length;e++)""!=d&&(d+=" "),d+=a.coords[b.usermap][e];
e=0;for(c in a.maprect[b.usermap])a.maprect[b.usermap].hasOwnProperty(c)&&"undefined"!==typeof a.maprect[b.usermap][c]&&null!==a.maprect[b.usermap][c]&&a.maprect[b.usermap][c]._id>e&&(e=Number(a.maprect[b.usermap][c]._id));e+=1;c={event:"newmaprect",object:"maprect"};c.points=d;c.id=e;window.console&&console.log(JSON.stringify(c));a.coords[b.usermap].length=0;a.g[b.usermap].removeChild(a.rect[b.usermap][1]);a.rect[b.usermap][1]=null}return!1}if("mapcurve"==a.mode[b.usermap]){if(1<a.coords[b.usermap].length){e=
a.svgcoord[b.usermap];e.x=d.clientX;e.y=d.clientY;e=s(e,a.g[b.usermap]);e.x/=a.map[f].precision/a.factor[b.usermap];e.y/=a.map[f].precision/a.factor[b.usermap];d=e.x;e=e.y;a.coords[b.usermap].push(k(e,a.precision)+","+k(d,a.precision));a.curve[b.usermap][1]._movingpoints="";a.curve[b.usermap][1].drawMapCurve();d="";for(e=0;e<a.coords[b.usermap].length;e++)""!=d&&(d+=" "),d+=a.coords[b.usermap][e];e=0;for(c in a.mapcurve[b.usermap])a.mapcurve[b.usermap].hasOwnProperty(c)&&"undefined"!==typeof a.mapcurve[b.usermap][c]&&
null!==a.mapcurve[b.usermap][c]&&a.mapcurve[b.usermap][c]._id>e&&(e=Number(a.mapcurve[b.usermap][c]._id));e+=1;c={event:"newmapcurve",object:"mapcurve"};c.points=d;c.id=e;window.console&&console.log(JSON.stringify(c));a.coords[b.usermap].length=0;a.g[b.usermap].removeChild(a.curve[b.usermap][1]);a.curve[b.usermap][1]=null}return!1}},a.div[b.usermap].onclick=function(d){if(!this._mapdragged&&!this._transformed&&"normal"!=a.mode[b.usermap]&&"edit"!=a.mode[b.usermap]){if("marker"==a.mode[b.usermap]){var e=
a.svgcoord[b.usermap];e.x=d.clientX;e.y=d.clientY;e=s(e,a.g[b.usermap]);e.x/=a.map[f].precision/a.factor[b.usermap];e.y/=a.map[f].precision/a.factor[b.usermap];var c=e.x,e=e.y,g=0,n;for(n in a.marker[b.usermap])a.marker[b.usermap].hasOwnProperty(n)&&"undefined"!==typeof a.marker[b.usermap][n]&&null!==a.marker[b.usermap][n]&&a.marker[b.usermap][n]._id>g&&(g=Number(a.marker[b.usermap][n]._id));var g=g+1,h={event:"newmarker",object:"marker"};h.y=k(e,a.precision);h.x=k(c,a.precision);h.id=g;window.console&&
console.log(JSON.stringify(h))}if("maplabel"==a.mode[b.usermap]){e=a.svgcoord[b.usermap];e.x=d.clientX;e.y=d.clientY;e=s(e,a.g[b.usermap]);e.x/=a.map[f].precision/a.factor[b.usermap];e.y/=a.map[f].precision/a.factor[b.usermap];c=e.x;e=e.y;g=0;for(n in a.maplabel[b.usermap])a.maplabel[b.usermap].hasOwnProperty(n)&&"undefined"!==typeof a.maplabel[b.usermap][n]&&null!==a.maplabel[b.usermap][n]&&a.maplabel[b.usermap][n]._id>g&&(g=Number(a.maplabel[b.usermap][n]._id));g+=1;h={event:"newmaplabel",object:"maplabel"};
h.y=k(e,a.precision);h.x=k(c,a.precision);h.id=g;window.console&&console.log(JSON.stringify(h))}"mappath"==a.mode[b.usermap]&&(e=a.svgcoord[b.usermap],e.x=d.clientX,e.y=d.clientY,e=s(e,a.g[b.usermap]),e.x/=a.map[f].precision/a.factor[b.usermap],e.y/=a.map[f].precision/a.factor[b.usermap],c=e.x,e=e.y,a.coords[b.usermap].push(k(e,a.precision)+","+k(c,a.precision)),"undefined"!=typeof a.path[b.usermap][1]&&null!==a.path[b.usermap][1]?a.path[b.usermap][1].addPoint(k(e,a.precision),k(c,a.precision)):(N.points=
k(e,a.precision)+","+k(c,a.precision),a.path[b.usermap][1]=new C(b,0,N)),a.path[b.usermap][1].drawMapPath());"mappoly"==a.mode[b.usermap]&&(e=a.svgcoord[b.usermap],e.x=d.clientX,e.y=d.clientY,e=s(e,a.g[b.usermap]),e.x/=a.map[f].precision/a.factor[b.usermap],e.y/=a.map[f].precision/a.factor[b.usermap],c=e.x,e=e.y,a.coords[b.usermap].push(k(e,a.precision)+","+k(c,a.precision)),"undefined"!=typeof a.poly[b.usermap][1]&&null!==a.poly[b.usermap][1]?a.poly[b.usermap][1].addPoint(k(e,a.precision),k(c,a.precision)):
(O.points=k(e,a.precision)+","+k(c,a.precision),a.poly[b.usermap][1]=new D(b,0,O)),a.poly[b.usermap][1].drawMapPoly());"mapcircle"==a.mode[b.usermap]&&0==a.coords[b.usermap].length&&(e=a.svgcoord[b.usermap],e.x=d.clientX,e.y=d.clientY,e=s(e,a.g[b.usermap]),e.x/=a.map[f].precision/a.factor[b.usermap],e.y/=a.map[f].precision/a.factor[b.usermap],c=e.x,e=e.y,a.coords[b.usermap].push(k(e,a.precision)+","+k(c,a.precision)),P.points=k(e,a.precision)+","+k(c,a.precision),a.circle[b.usermap][1]=new E(b,0,
P),a.circle[b.usermap][1]._movingpoints=k(e,a.precision)+","+k(c,a.precision),a.circle[b.usermap][1].drawMapCircle());"maprect"==a.mode[b.usermap]&&0==a.coords[b.usermap].length&&(e=a.svgcoord[b.usermap],e.x=d.clientX,e.y=d.clientY,e=s(e,a.g[b.usermap]),e.x/=a.map[f].precision/a.factor[b.usermap],e.y/=a.map[f].precision/a.factor[b.usermap],c=e.x,e=e.y,a.coords[b.usermap].push(k(e,a.precision)+","+k(c,a.precision)),Q.points=k(e,a.precision)+","+k(c,a.precision),a.rect[b.usermap][1]=new F(b,0,Q),a.rect[b.usermap][1]._movingpoints=
k(e,a.precision)+","+k(c,a.precision),a.rect[b.usermap][1].drawMapRect());"mapcurve"==a.mode[b.usermap]&&2>a.coords[b.usermap].length&&(e=a.svgcoord[b.usermap],e.x=d.clientX,e.y=d.clientY,e=s(e,a.g[b.usermap]),e.x/=a.map[f].precision/a.factor[b.usermap],e.y/=a.map[f].precision/a.factor[b.usermap],c=e.x,e=e.y,a.coords[b.usermap].push(k(e,a.precision)+","+k(c,a.precision)),"undefined"!=typeof a.curve[b.usermap][1]&&null!==a.curve[b.usermap][1]?a.curve[b.usermap][1].addPoint(k(e,a.precision),k(c,a.precision)):
(R.points=k(e,a.precision)+","+k(c,a.precision),a.curve[b.usermap][1]=new G(b,0,R)),a.curve[b.usermap][1].drawMapCurve())}});a.touchdevices&&(a.div[b.usermap].ontouchstart=function(a){a.preventDefault&&a.preventDefault();this._mousedown=!0;1==a.touches.length?(this._mousepositionx=a.touches[0].pageX,this._mousepositiony=a.touches[0].pageY,this._mapdragged=!1):2==a.touches.length&&(this._transformed=!0,this._pos={},this._pos.start=[],this._pos.start[0]={},this._pos.start[1]={},this._pos.start[0].x=
a.touches[0].pageX,this._pos.start[0].y=a.touches[0].pageY,this._pos.start[1].x=a.touches[1].pageX,this._pos.start[1].y=a.touches[1].pageY)});a.touchdevices&&(a.div[b.usermap].ontouchmove=function(d){var e;d.preventDefault&&d.preventDefault();if(!this._mousedown)return!1;if(1==d.touches.length){if(a.usermap[b.usermap].map.zoom_setting.draggable&&!this._transformed&&(10<Math.abs(d.touches[0].pageX-this._mousepositionx)||10<Math.abs(d.touches[0].pageY-this._mousepositiony))){this._mapdragged=!0;var c=
(this._mousepositiony-d.touches[0].pageY)/a.zoom[b.usermap].currentzoom;a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx+(this._mousepositionx-d.touches[0].pageX)/a.zoom[b.usermap].currentzoom,a.precision);a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty-c,a.precision);this._mousepositionx=d.touches[0].pageX;this._mousepositiony=d.touches[0].pageY;t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx)}}else if(2==d.touches.length&&a.usermap[b.usermap].map.zoom_setting.mouseWheel){a.zoom[b.usermap].prevzoom=
a.zoom[b.usermap].currentzoom;c=x(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom);this._pos.move=[];this._pos.move[0]={};this._pos.move[1]={};this._pos.move[0].x=d.touches[0].pageX;this._pos.move[0].y=d.touches[0].pageY;this._pos.move[1].x=d.touches[1].pageX;this._pos.move[1].y=d.touches[1].pageY;var g=H(this._pos.move[0],this._pos.move[1]),n=H(this._pos.start[0],this._pos.start[1]);k(a.zoom[b.usermap].currentzoom);e=this._pos.start[0];var h=this._pos.start[1];d=(e.x+h.x)/2;e=(h.y+e.y)/
2;h=a.svgcoord[b.usermap];h.x=d;h.y=e;for(var h=s(h,a.g[b.usermap]),m=this,p=0,r=0;m;)p+=m.offsetLeft,r+=m.offsetTop,m=m.offsetParent;h.x/=a.map[f].precision/a.factor[b.usermap];h.y/=a.map[f].precision/a.factor[b.usermap];50<Math.abs(g-n)&&(this._transformed=!0,g>n?20>c&&(a.zoom[b.usermap].currentzoom=k(1.5*a.zoom[b.usermap].currentzoom,a.precision),a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx-0.5*((parseInt(this.style.width)/2-(d-p))/a.zoom[b.usermap].currentzoom),a.precision),a.zoom[b.usermap].currenty=
k(a.zoom[b.usermap].currenty+0.5*((parseInt(this.style.height)/2-(e-r))/a.zoom[b.usermap].currentzoom),a.precision),t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx)):1<c&&(a.zoom[b.usermap].currentzoom=k(a.zoom[b.usermap].currentzoom/1.5,a.precision),a.zoom[b.usermap].currentx=k(a.zoom[b.usermap].currentx+(parseInt(this.style.width)/2-(d-p))/a.zoom[b.usermap].currentzoom*(1-1/1.5),a.precision),a.zoom[b.usermap].currenty=k(a.zoom[b.usermap].currenty-(parseInt(this.style.height)/
2-(e-r))/a.zoom[b.usermap].currentzoom*(1-1/1.5),a.precision),t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx)),this._pos.start[0].x=this._pos.move[0].x,this._pos.start[0].y=this._pos.move[0].y,this._pos.start[1].x=this._pos.move[1].x,this._pos.start[1].y=this._pos.move[1].y)}});a.touchdevices&&(a.div[b.usermap].ontouchend=function(a){a.preventDefault&&a.preventDefault();0==a.touches.length&&(this._mousedown=this._mapdragged=this._transformed=!1,this._mousepositiony=
this._mousepositionx=0,this._pos={})});a.background[b.usermap]=document.createElement("div");for(var n in a.usermap[b.usermap].div.style)a.usermap[b.usermap].div.style.hasOwnProperty(n)&&("backgroundImage"==n?""!=a.usermap[b.usermap].div.style[n]&&(a.background[b.usermap].style[n]="url('"+a.base[b.usermap]+a.usermap[b.usermap].div.style[n]+"?"+Math.random(1E5)+"')"):a.background[b.usermap].style[n]=a.usermap[b.usermap].div.style[n]);a.background[b.usermap].style.position="absolute";a.background[b.usermap].style.top=
"0px";a.background[b.usermap].style.left="0px";a.background[b.usermap].style.width="100%";a.background[b.usermap].style.height="100%";a.div[b.usermap].appendChild(a.background[b.usermap]);a.foreground[b.usermap]=document.createElement("div");a.foreground[b.usermap].style.width="100%";a.foreground[b.usermap].style.height="100%";a.foreground[b.usermap].style.position="absolute";a.foreground[b.usermap].style.top=a.usermap[b.usermap].div.style.borderWidth;a.foreground[b.usermap].style.left=a.usermap[b.usermap].div.style.borderWidth;
a.div[b.usermap].appendChild(a.foreground[b.usermap]);a.zoomcontrol[b.usermap]=document.createElement("div");a.zoomcontrol[b.usermap].style.position="absolute";a.zoomcontrol[b.usermap].style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+5+"px";a.zoomcontrol[b.usermap].style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+5+"px";a.zoomcontrol[b.usermap].style.zIndex="1";a.zoomcontrol[b.usermap].style.backgroundColor="rgba(0,0,0,0)";a.panhome[b.usermap]=document.createElement("div");
a.panhome[b.usermap].style.width=a.touchdevices?"48px":"16px";a.panhome[b.usermap].style.height=a.touchdevices?"48px":"16px";a.panhome[b.usermap].style.position="absolute";a.panhome[b.usermap].style.top="5px";a.panhome[b.usermap].style.left="5px";a.panhome[b.usermap].style.backgroundColor=a.usermap[b.usermap].map.zoom_setting.style.backgroundColor;a.panhome[b.usermap].style.borderWidth="1px";a.panhome[b.usermap].style.borderColor=a.usermap[b.usermap].map.zoom_setting.style.borderColor;a.panhome[b.usermap].style.borderStyle=
"solid";a.panhome[b.usermap].style.borderRadius="2px";a.panhome[b.usermap].unselectable="on";a.panhome[b.usermap].style.visibility="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.homeControl?a.usermap[b.usermap].map.zoom_setting.homeControl?"visible":"hidden":"visible";a.panhome[b.usermap].style.cursor="pointer";a.panhome[b.usermap].title="home";h=p("svg");h.setAttribute("xmlns","http://www.w3.org/2000/svg");h.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");h.setAttribute("version",
"1.1");a.touchdevices?(h.setAttribute("width","48px"),h.setAttribute("height","48px")):(h.setAttribute("width","16px"),h.setAttribute("height","16px"));h.style.overflow="hidden";c=p("polyline");a.touchdevices?c.setAttribute("points","3.5,26.5 24.5,3.5 45.5,26.5"):c.setAttribute("points","2.5,9.5 8.5,3.5 14.5,9.5");c.style.fill="none";c.style.stroke=a.usermap[b.usermap].map.zoom_setting.style.symbolColor;c.style.strokeWidth=1.5;h.appendChild(c);c=p("polyline");a.touchdevices?c.setAttribute("points",
"5.5,24.5 5.5,46.5 43.5,46.5 43.5,24.5"):c.setAttribute("points","4.5,7.5 4.5,14.5 12.5,14.5 12.5,7.5");c.style.fill="none";c.style.stroke=a.usermap[b.usermap].map.zoom_setting.style.symbolColor;c.style.strokeWidth=1;h.appendChild(c);c=p("polyline");a.touchdevices?c.setAttribute("points","16.5,46.5 16.5,25.5 32.5,25.5 32.5,46.5"):c.setAttribute("points","6.5,14.5 6.5,9.5 10.5,9.5 10.5,14.5");c.style.fill="none";c.style.stroke=a.usermap[b.usermap].map.zoom_setting.style.symbolColor;c.style.strokeWidth=
1;h.appendChild(c);a.panhome[b.usermap].appendChild(h);a.panhome[b.usermap].onmouseup=function(a){};a.panhome[b.usermap].onmousedown=function(a){};a.panhome[b.usermap].onmousemove=function(a){};a.panhome[b.usermap].onmousewheel=function(a){};a.panhome[b.usermap].addEventListener&&a.panhome[b.usermap].addEventListener("DOMMouseScroll",function(a){},!1);a.panhome[b.usermap].onclick=function(d){d.stopPropagation&&d.stopPropagation();t(b,a.usermap[b.usermap].map.zoom,a.usermap[b.usermap].map.y,a.usermap[b.usermap].map.x)};
a.touchdevices&&(a.panhome[b.usermap].ontouchstart=function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();this._touch=1==a.touches.length?!0:!1});a.touchdevices&&(a.panhome[b.usermap].ontouchend=function(d){this._touch&&t(b,a.usermap[b.usermap].map.zoom,a.usermap[b.usermap].map.y,a.usermap[b.usermap].map.x)});a.zoomcontrol[b.usermap].appendChild(a.panhome[b.usermap]);a.zoomin[b.usermap]=document.createElement("div");a.zoomin[b.usermap].style.width=a.touchdevices?"48px":
"16px";a.zoomin[b.usermap].style.height=a.touchdevices?"48px":"16px";a.zoomin[b.usermap].style.position="absolute";a.zoomin[b.usermap].style.top=a.touchdevices?"60px":"24px";a.zoomin[b.usermap].style.left="5px";a.zoomin[b.usermap].style.backgroundColor=a.usermap[b.usermap].map.zoom_setting.style.backgroundColor;a.zoomin[b.usermap].style.borderWidth="1px";a.zoomin[b.usermap].style.borderColor=a.usermap[b.usermap].map.zoom_setting.style.borderColor;a.zoomin[b.usermap].style.borderStyle="solid";a.zoomin[b.usermap].style.borderRadius=
"2px";a.zoomin[b.usermap].style.unselectable="on";a.zoomin[b.usermap].style.visibility="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.zoomControl?a.usermap[b.usermap].map.zoom_setting.zoomControl?"visible":"hidden":"visible";a.zoomin[b.usermap].style.cursor="pointer";a.zoomin[b.usermap].title="zoom in";h=p("svg");h.setAttribute("xmlns","http://www.w3.org/2000/svg");h.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");h.setAttribute("version","1.1");a.touchdevices?(h.setAttribute("width",
"48px"),h.setAttribute("height","48px")):(h.setAttribute("width","16px"),h.setAttribute("height","16px"));h.style.overflow="hidden";c=p("polyline");a.touchdevices?c.setAttribute("points","5,24,42,24"):c.setAttribute("points","3,8 13,8");c.style.fill="none";c.style.stroke=a.usermap[b.usermap].map.zoom_setting.style.symbolColor;c.style.strokeWidth=2;h.appendChild(c);c=p("polyline");a.touchdevices?c.setAttribute("points","24,5 24,42"):c.setAttribute("points","8,3 8,13");c.style.fill="none";c.style.stroke=
a.usermap[b.usermap].map.zoom_setting.style.symbolColor;c.style.strokeWidth=2;h.appendChild(c);a.zoomin[b.usermap].appendChild(h);a.zoomin[b.usermap].onmouseup=function(a){};a.zoomin[b.usermap].onmousedown=function(a){};a.zoomin[b.usermap].onmousemove=function(a){};a.zoomin[b.usermap].onmousewheel=function(a){};a.zoomin[b.usermap].addEventListener&&a.zoomin[b.usermap].addEventListener("DOMMouseScroll",function(a){},!1);a.zoomin[b.usermap].onclick=function(d){d.preventDefault&&d.preventDefault();d.stopPropagation&&
d.stopPropagation();a.zoom[b.usermap].prevzoom=a.zoom[b.usermap].currentzoom;20>x(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom)&&(a.zoom[b.usermap].currentzoom=k(1.5*a.zoom[b.usermap].currentzoom,a.precision),t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx))};a.touchdevices&&(a.zoomin[b.usermap].ontouchstart=function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();this._touch=1==a.touches.length?!0:!1});a.touchdevices&&
(a.zoomin[b.usermap].ontouchend=function(d){a.zoom[b.usermap].prevzoom=a.zoom[b.usermap].currentzoom;d=x(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom);this._touch&&20>d&&(a.zoom[b.usermap].currentzoom=k(1.5*a.zoom[b.usermap].currentzoom,a.precision),t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx))});a.zoomcontrol[b.usermap].appendChild(a.zoomin[b.usermap]);a.zoomout[b.usermap]=document.createElement("div");a.zoomout[b.usermap].style.width=a.touchdevices?
"48px":"16px";a.zoomout[b.usermap].style.height=a.touchdevices?"48px":"16px";a.zoomout[b.usermap].style.position="absolute";a.zoomout[b.usermap].style.top=a.touchdevices?"115px":"43px";a.zoomout[b.usermap].style.left="5px";a.zoomout[b.usermap].style.backgroundColor=a.usermap[b.usermap].map.zoom_setting.style.backgroundColor;a.zoomout[b.usermap].style.borderWidth="1px";a.zoomout[b.usermap].style.borderColor=a.usermap[b.usermap].map.zoom_setting.style.borderColor;a.zoomout[b.usermap].style.borderStyle=
"solid";a.zoomout[b.usermap].style.borderRadius="2px";a.zoomout[b.usermap].unselectable="on";a.zoomout[b.usermap].style.visibility="undefined"!=typeof a.usermap[b.usermap].map.zoom_setting.zoomControl?a.usermap[b.usermap].map.zoom_setting.zoomControl?"visible":"hidden":"visible";a.zoomout[b.usermap].style.cursor="pointer";a.zoomout[b.usermap].title="zoom out";h=p("svg");h.setAttribute("xmlns","http://www.w3.org/2000/svg");h.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");h.setAttribute("version",
"1.1");a.touchdevices?(h.setAttribute("width","48px"),h.setAttribute("height","48px")):(h.setAttribute("width","16px"),h.setAttribute("height","16px"));h.style.overflow="hidden";c=p("polyline");a.touchdevices?c.setAttribute("points","5,24,42,24"):c.setAttribute("points","3,8 13,8");c.style.fill="none";c.style.stroke=a.usermap[b.usermap].map.zoom_setting.style.symbolColor;c.style.strokeWidth=2;h.appendChild(c);a.zoomout[b.usermap].appendChild(h);a.zoomout[b.usermap].onmouseup=function(a){};a.zoomout[b.usermap].onmousedown=
function(a){};a.zoomout[b.usermap].onmousemove=function(a){};a.zoomout[b.usermap].onmousewheel=function(a){};a.zoomout[b.usermap].addEventListener&&a.zoomout[b.usermap].addEventListener("DOMMouseScroll",function(a){},!1);a.zoomout[b.usermap].onclick=function(d){d.stopPropagation&&d.stopPropagation();a.zoom[b.usermap].prevzoom=a.zoom[b.usermap].currentzoom;1<x(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom)&&(a.zoom[b.usermap].currentzoom=k(a.zoom[b.usermap].currentzoom/1.5,a.precision),
t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx))};a.touchdevices&&(a.zoomout[b.usermap].ontouchstart=function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();this._touch=1==a.touches.length?!0:!1});a.touchdevices&&(a.zoomout[b.usermap].ontouchend=function(d){this._touch&&(a.zoom[b.usermap].prevzoom=a.zoom[b.usermap].currentzoom,1<x(a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].initzoom)&&(a.zoom[b.usermap].currentzoom=k(a.zoom[b.usermap].currentzoom/
1.5,a.precision),t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx)))});a.zoomcontrol[b.usermap].appendChild(a.zoomout[b.usermap]);a.div[b.usermap].appendChild(a.zoomcontrol[b.usermap]);a.local&&(h=document.createElement("script"),h.type="application/javascript",h.src=b.base+"imap5custommap_"+a.usermap[b.usermap].map.id+".js?"+Math.random(1E5),h.onerror=function(){},h.onload=function(){var d=a.usermap[b.usermap].map.id;a.svg[b.usermap]=p("svg");a.svg[b.usermap].setAttribute("xmlns",
"http://www.w3.org/2000/svg");a.svg[b.usermap].setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");a.svg[b.usermap].setAttribute("width",a.div[b.usermap].clientWidth+"px");a.svg[b.usermap].setAttribute("height",a.div[b.usermap].clientHeight+"px");a.svg[b.usermap].style.overflow="hidden";a.foreground[b.usermap].appendChild(a.svg[b.usermap]);a.svgcoord[b.usermap]=a.svg[b.usermap].createSVGPoint();a.g[b.usermap]=p("g");a.svg[b.usermap].appendChild(a.g[b.usermap]);var e=p("image"),c=p("g");e.setAttributeNS("http://www.w3.org/1999/xlink",
"xlink:href",a.base[b.usermap]+a.usermap[b.usermap].map.src);e.setAttribute("width",a.usermap[b.usermap].map.width);e.setAttribute("height",a.usermap[b.usermap].map.height);e.setAttribute("x","-"+parseFloat(a.usermap[b.usermap].map.width)/2+"px");e.setAttribute("y","-"+parseFloat(a.usermap[b.usermap].map.height)/2+"px");c.appendChild(e);c.setAttribute("transform","scale(1,-1)");a.g[b.usermap].appendChild(c);e=p("g");a.g[b.usermap].appendChild(e);e.setAttribute("id","imap5custom_"+b.usermap+"_centerref");
var c=p("g"),g=p("circle");c.appendChild(g);e.appendChild(c);g.setAttribute("cx",0);g.setAttribute("cy",0);g.setAttribute("r",0);g.setAttribute("stroke","#006600");g.setAttribute("stroke-width",0);g.setAttribute("fill","#ff0000");c.setAttribute("transform","scale(1,-1)");a.center[b.usermap]=e;a.center[b.usermap].setAttribute("transform","scale("+k(a.map[d].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")");for(var f in a.usermap[b.usermap].map.mappoly)a.usermap[b.usermap].map.mappoly.hasOwnProperty(f)&&
(a.mappoly[b.usermap][f]=new D(b,f,a.usermap[b.usermap].map.mappoly[f]));for(f in a.usermap[b.usermap].map.mapcircle)a.usermap[b.usermap].map.mapcircle.hasOwnProperty(f)&&(a.mapcircle[b.usermap][f]=new E(b,f,a.usermap[b.usermap].map.mapcircle[f]));for(f in a.usermap[b.usermap].map.maprect)a.usermap[b.usermap].map.maprect.hasOwnProperty(f)&&(a.maprect[b.usermap][f]=new F(b,f,a.usermap[b.usermap].map.maprect[f]));for(f in a.usermap[b.usermap].map.mappath)a.usermap[b.usermap].map.mappath.hasOwnProperty(f)&&
(a.mappath[b.usermap][f]=new C(b,f,a.usermap[b.usermap].map.mappath[f]));for(f in a.usermap[b.usermap].map.mapcurve)a.usermap[b.usermap].map.mapcurve.hasOwnProperty(f)&&(a.mapcurve[b.usermap][f]=new G(b,f,a.usermap[b.usermap].map.mapcurve[f]));for(f in a.usermap[b.usermap].map.maplabel)a.usermap[b.usermap].map.maplabel.hasOwnProperty(f)&&(a.maplabel[b.usermap][f]=new L(b,f,a.usermap[b.usermap].map.maplabel[f]));for(f in a.usermap[b.usermap].map.marker)a.usermap[b.usermap].map.marker.hasOwnProperty(f)&&
(a.marker[b.usermap][f]=new K(b,f,a.usermap[b.usermap].map.marker[f]));for(f in a.usermap[b.usermap].map.maplegend)a.usermap[b.usermap].map.maplegend.hasOwnProperty(f)&&(a.maplegend[b.usermap][f]=new M(b,f,a.usermap[b.usermap].map.maplegend[f]));"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&("undefined"!=typeof a.usermap[b.usermap].map.categorylegend.enable&&a.usermap[b.usermap].map.categorylegend.enable)&&(a.categorylegend[b.usermap]=new I(b,a.usermap[b.usermap].map.categorylegend),
B(b));"undefined"!=typeof a.usermap[b.usermap].map.maptitle&&(a.maptitle[b.usermap]=new J(b,a.usermap[b.usermap].map.maptitle));0+a.map[d].precision!=a.map[d].point&&U(b);d=document.createElement("div");a.div[b.usermap].appendChild(d);d.innerHTML="<a href=''></a>";d.style.position="absolute";d.style.bottom="-1px";d.style.right="1px";d.style.font="11px Verdana";d.style.backgroundColor="#ffffff";d.style.cursor="none";d.style.visibility=
"hidden";a.zoom[b.usermap].loadeditingsetting?t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currenty,a.zoom[b.usermap].currentx):t(b,a.zoom[b.usermap].currentzoom,a.zoom[b.usermap].currentlat,a.zoom[b.usermap].currentlng)},document.body.appendChild(h))},U=function(b){var f=p("g");f.style.opacity=0.2;a.svg[b.usermap].appendChild(f);var k=p("text");k.appendChild(document.createTextNode(""));k.style.cursor="default";k.style.fill="#000000";k.style.fontFamily="Arial";k.style.fontWeight=
"bold";k.style.pointerEvents="none";f.appendChild(k);k.setAttribute("x",-4096);k.setAttribute("y",-4096);k.setAttribute("text-anchor","middle");f=parseInt(a.div[b.usermap].clientWidth/8);for(k.style.fontSize=f+"px";k.getBBox().width>a.div[b.usermap].clientWidth;)f-=2,k.style.fontSize=f+"px";for(;k.getBBox().height>a.div[b.usermap].clientHeight;)f-=2,k.style.fontSize=f+"px";k.style.fontSize=f-2+"px";k.setAttribute("x",a.div[b.usermap].clientWidth/2);k.setAttribute("y",a.div[b.usermap].clientHeight/
2+parseInt(k.style.fontSize)/2);var c=document.createElement("div");a.div[b.usermap].appendChild(c);c.appendChild(document.createTextNode(""));c.style.position="absolute";c.style.bottom=0-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";c.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";c.style.font="11px Verdana";c.style.backgroundColor="#ffffff";c.style.padding="3px";c.style.opacity=0.5;c.style.cursor="pointer";c.onclick=function(){location.href=
""};a.touchdevices&&(c.ontouchstart=function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();this._touch=1==a.touches.length?!0:!1});a.touchdevices&&(c.ontouchend=function(a){this._touch&&(location.href="http://www.imapbuilder.com/")});c.onmouseover=function(){c.style.opacity=1};c.onmouseout=function(){c.style.opacity=0.5}};a.zoomTo=function(a,f,k,c){t(a,f,k,c)};a.zoomToXY=function(a,f,k,c){t(a,f,k,c)};var t=function(b,f,h,c){var g=a.usermap[b.usermap].map.id,
d=a.div[b.usermap].clientWidth,n=a.div[b.usermap].clientHeight;k(a.zoom[b.usermap].currentzoom,a.precision);a.zoom[b.usermap].currentzoom=k(f,a.precision);a.zoom[b.usermap].currentx=k(c,a.precision);a.zoom[b.usermap].currenty=k(h,a.precision);a.g[b.usermap].setAttribute("transform","translate("+k(d/2+-c*f,a.precision)+","+k(n/2+h*f,a.precision)+") scale("+k(f/(a.map[g].precision/a.factor[b.usermap]),a.precision)+",-"+k(f/(a.map[g].precision/a.factor[b.usermap]),a.precision)+")");window.console&&(d=
{event:"poschange",object:"map"},d.zoom=k(f,a.precision),d.x=k(c,a.precision),d.y=k(h,a.precision),window.console&&console.log(JSON.stringify(d)));for(var l in a.marker[b.usermap])a.marker[b.usermap].hasOwnProperty(l)&&a.marker[b.usermap][l].setAttribute("transform","translate("+k(a.marker[b.usermap][l]._lng,a.precision)+","+k(a.marker[b.usermap][l]._lat,a.precision)+") scale("+k(a.map[g].precision/a.factor[b.usermap]/f,a.precision)+")");for(l in a.maplabel[b.usermap])a.maplabel[b.usermap].hasOwnProperty(l)&&
a.maplabel[b.usermap][l].setAttribute("transform","translate("+k(a.maplabel[b.usermap][l]._lng,a.precision)+","+k(a.maplabel[b.usermap][l]._lat,a.precision)+") scale("+k(a.map[g].precision/a.factor[b.usermap]/f,a.precision)+")");for(l in a.mappoly[b.usermap])if(a.mappoly[b.usermap].hasOwnProperty(l)){a.mappoly[b.usermap][l].getElementsByTagName("polygon")[0].setAttribute("stroke-width",k(a.mappoly[b.usermap][l]._options.style.strokeWidth/f*(a.map[g].precision/a.factor[b.usermap]),a.precision));if("undefined"!==
typeof a.mappoly[b.usermap][l]._options.style.strokeDasharray&&"none"!==a.mappoly[b.usermap][l]._options.style.strokeDasharray){h=a.mappoly[b.usermap][l]._options.style.strokeDasharray.split(",");c="";for(var e=0;e<h.length;e++)""!=c&&(c+=","),c+=k(h[e]/a.zoom[b.usermap].currentzoom*(a.map[g].precision/a.factor[b.usermap]),a.precision);a.mappoly[b.usermap][l].getElementsByTagName("polygon")[0].setAttribute("stroke-dasharray",c)}for(e in a.mappoly[b.usermap][l]._mainvertices)a.mappoly[b.usermap][l]._mainvertices.hasOwnProperty(e)&&
a.mappoly[b.usermap][l]._mainvertices[e].rescale();for(e in a.mappoly[b.usermap][l]._subvertices)a.mappoly[b.usermap][l]._subvertices.hasOwnProperty(e)&&a.mappoly[b.usermap][l]._subvertices[e].rescale();a.mappoly[b.usermap][l].toggleCategory()}"mappoly"==a.mode[b.usermap]&&"undefined"!=typeof a.poly[b.usermap][1]&&(0<a.poly[b.usermap][1].count()?a.poly[b.usermap][1].getElementsByTagName("polygon")[0].setAttribute("stroke-width",k(a.poly[b.usermap][1]._options.style.strokeWidth/f*(a.map[g].precision/
a.factor[b.usermap]),a.precision)):a.poly[b.usermap][1].getElementsByTagName("polyline")[0].setAttribute("stroke-width",k(a.poly[b.usermap][1]._options.style.strokeWidth/f*(a.map[g].precision/a.factor[b.usermap]),a.precision)));for(l in a.mapcircle[b.usermap])if(a.mapcircle[b.usermap].hasOwnProperty(l)){a.mapcircle[b.usermap][l].getElementsByTagName("circle")[0].setAttribute("stroke-width",k(a.mapcircle[b.usermap][l]._options.style.strokeWidth/f*(a.map[g].precision/a.factor[b.usermap]),a.precision));
if("undefined"!==typeof a.mapcircle[b.usermap][l]._options.style.strokeDasharray&&"none"!==a.mapcircle[b.usermap][l]._options.style.strokeDasharray){h=a.maprect[b.usermap][l]._options.style.strokeDasharray.split(",");c="";for(e=0;e<h.length;e++)""!=c&&(c+=","),c+=k(h[e]/a.zoom[b.usermap].currentzoom*(a.map[g].precision/a.factor[b.usermap]),a.precision);a.mapcircle[b.usermap][l].getElementsByTagName("circle")[0].setAttribute("stroke-dasharray",c)}for(e in a.mapcircle[b.usermap][l]._mainvertices)a.mapcircle[b.usermap][l]._mainvertices.hasOwnProperty(e)&&
a.mapcircle[b.usermap][l]._mainvertices[e].rescale();a.mapcircle[b.usermap][l].toggleCategory()}"mapcircle"==a.mode[b.usermap]&&"undefined"!=typeof a.circle[b.usermap][1]&&a.circle[b.usermap][1].getElementsByTagName("circle")[0].setAttribute("stroke-width",k(a.circle[b.usermap][1]._options.style.strokeWidth/f*(a.map[g].precision/a.factor[b.usermap]),a.precision));for(l in a.maprect[b.usermap])if(a.maprect[b.usermap].hasOwnProperty(l)){a.maprect[b.usermap][l].getElementsByTagName("polygon")[0].setAttribute("stroke-width",
k(a.maprect[b.usermap][l]._options.style.strokeWidth/f*(a.map[g].precision/a.factor[b.usermap]),a.precision));if("undefined"!==typeof a.maprect[b.usermap][l]._options.style.strokeDasharray&&"none"!==a.maprect[b.usermap][l]._options.style.strokeDasharray){h=a.maprect[b.usermap][l]._options.style.strokeDasharray.split(",");c="";for(e=0;e<h.length;e++)""!=c&&(c+=","),c+=k(h[e]/a.zoom[b.usermap].currentzoom*(a.map[g].precision/a.factor[b.usermap]),a.precision);a.maprect[b.usermap][l].getElementsByTagName("polygon")[0].setAttribute("stroke-dasharray",
c)}for(e in a.maprect[b.usermap][l]._mainvertices)a.maprect[b.usermap][l]._mainvertices.hasOwnProperty(e)&&a.maprect[b.usermap][l]._mainvertices[e].rescale();a.maprect[b.usermap][l].toggleCategory()}"maprect"==a.mode[b.usermap]&&"undefined"!=typeof a.rect[b.usermap][1]&&a.rect[b.usermap][1].getElementsByTagName("polygon")[0].setAttribute("stroke-width",k(a.rect[b.usermap][1]._options.style.strokeWidth/f*(a.map[g].precision/a.factor[b.usermap]),a.precision));for(l in a.mappath[b.usermap])if(a.mappath[b.usermap].hasOwnProperty(l)){a.mappath[b.usermap][l].getElementsByTagName("polyline")[0].setAttribute("stroke-width",
k(a.mappath[b.usermap][l]._options.style.strokeWidth/f*(a.map[g].precision/a.factor[b.usermap]),a.precision));if("undefined"!==typeof a.mappath[b.usermap][l]._options.style.strokeDasharray&&"none"!==a.mappath[b.usermap][l]._options.style.strokeDasharray){h=a.mappath[b.usermap][l]._options.style.strokeDasharray.split(",");c="";for(e=0;e<h.length;e++)""!=c&&(c+=","),c+=k(h[e]/a.zoom[b.usermap].currentzoom*(a.map[g].precision/a.factor[b.usermap]),a.precision);a.mappath[b.usermap][l].getElementsByTagName("polyline")[0].setAttribute("stroke-dasharray",
c)}for(e in a.mappath[b.usermap][l]._mainvertices)a.mappath[b.usermap][l]._mainvertices.hasOwnProperty(e)&&a.mappath[b.usermap][l]._mainvertices[e].rescale();for(e in a.mappath[b.usermap][l]._subvertices)a.mappath[b.usermap][l]._subvertices.hasOwnProperty(e)&&a.mappath[b.usermap][l]._subvertices[e].rescale();a.mappath[b.usermap][l].toggleCategory()}"mappath"==a.mode[b.usermap]&&"undefined"!=typeof a.path[b.usermap][1]&&a.path[b.usermap][1].getElementsByTagName("polyline")[0].setAttribute("stroke-width",
k(a.path[b.usermap][1]._options.style.strokeWidth/f*(a.map[g].precision/a.factor[b.usermap]),a.precision));for(l in a.mapcurve[b.usermap])if(a.mapcurve[b.usermap].hasOwnProperty(l)){a.mapcurve[b.usermap][l].getElementsByTagName("path")[0].setAttribute("stroke-width",k(a.mapcurve[b.usermap][l]._options.style.strokeWidth/f*(a.map[g].precision/a.factor[b.usermap]),a.precision));if("undefined"!==typeof a.mapcurve[b.usermap][l]._options.style.strokeDasharray&&"none"!==a.mapcurve[b.usermap][l]._options.style.strokeDasharray){h=
a.mapcurve[b.usermap][l]._options.style.strokeDasharray.split(",");c="";for(e=0;e<h.length;e++)""!=c&&(c+=","),c+=k(h[e]/a.zoom[b.usermap].currentzoom*(a.map[g].precision/a.factor[b.usermap]),a.precision);a.mapcurve[b.usermap][l].getElementsByTagName("path")[0].setAttribute("stroke-dasharray",c)}for(e in a.mapcurve[b.usermap][l]._mainvertices)a.mapcurve[b.usermap][l]._mainvertices.hasOwnProperty(e)&&a.mapcurve[b.usermap][l]._mainvertices[e].rescale();a.mapcurve[b.usermap][l].toggleCategory()}"mapcurve"==
a.mode[b.usermap]&&"undefined"!=typeof a.curve[b.usermap][1]&&a.curve[b.usermap][1].getElementsByTagName("path")[0].setAttribute("stroke-width",k(a.curve[b.usermap][1]._options.style.strokeWidth/f*(a.map[g].precision/a.factor[b.usermap]),a.precision));a.center[b.usermap].setAttribute("transform","scale("+k(a.map[g].precision/a.factor[b.usermap]/f,a.precision)+")");a.zoom[b.usermap].prevzoom=f};a.getLatLng=function(b){var f=a.zoom[b.usermap].currentzoom,h=a.zoom[b.usermap].currentx,c={event:"getlatlng",
object:"map"};c.y=k(a.zoom[b.usermap].currenty,a.precision);c.x=k(h,a.precision);c.zoom=k(f,a.precision);window.console&&console.log(JSON.stringify(c))};var s=function(a,f){var k=f.getScreenCTM();return a.matrixTransform(k.inverse())},N={name:"Path 1",points:"",style:{stroke:"#000000",strokeWidth:"2",strokeOpacity:"1"}},O={name:"Polygon 1",points:"",fill:"#000000",fillOpacity:0.5,style:{stroke:"#000000",strokeWidth:"2",strokeOpacity:"1"}},P={name:"Circle 1",points:"",fill:"#000000",fillOpacity:0.5,
style:{stroke:"#000000",strokeWidth:"2",strokeOpacity:"1"}},Q={name:"Rectangle 1",points:"",fill:"#000000",fillOpacity:0.5,style:{stroke:"#000000",strokeWidth:"2",strokeOpacity:"1"}},R={name:"Curve 1",points:"",style:{stroke:"#000000",strokeWidth:"2",strokeOpacity:"1"}},K=function(b,f,h){var c=a.usermap[b.usermap].map.id,g=p("g");a.g[b.usermap].appendChild(g);g._options=h;g._id=f;g.setAttribute("id","imap5custom_"+b.usermap+"_marker_"+f);g._lat=h.y;g._lng=h.x;g._dx=g._lng*(a.map[c].precision/a.factor[b.usermap]);
g._dy=parseFloat(g._lat)*(a.map[c].precision/a.factor[b.usermap]);g._show=!0;g.setPosition=function(d){this._lat=a.usermap[b.usermap].map.marker[this._id].y=d.y;this._lng=a.usermap[b.usermap].map.marker[this._id].x=d.x;this._dy=parseFloat(this._lat)*(a.map[c].precision/a.factor[b.usermap]);this._dx=this._lng*(a.map[c].precision/a.factor[b.usermap]);g.setAttribute("transform","translate("+k(this._dx,a.precision)+","+k(this._dy,a.precision)+") scale("+k(a.map[c].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,
a.precision)+")")};g.getPosition=function(){var a={};a.y=this._lat;a.x=this._lng;return a};g.setIcon=function(a){this._options.icon=a;this.drawMarker()};g.setOptions=function(a){this._options=a};g.setLabel=function(a){this._options.label=a;this.drawMarker()};g.hide=function(){this.style.visibility="hidden";this._show=!1};g.show=function(){this.style.visibility="visible";this._show=!0};g.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&
a.usermap[b.usermap].map.categorylegend.enable?0!=this._options.categoryid&&("undefined"!=typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this._options.categoryid)?this.show():this.hide():this.show()):this.show():this.show()};g.drawMarker=function(){var d=this.getElementsByTagName("g")[0];"undefined"!=typeof d&&this.removeChild(d);d=this.getElementsByTagName("text")[0];"undefined"!=typeof d&&this.removeChild(d);var d=p("g"),f=p("image");d.appendChild(f);this.appendChild(d);
"local"==this._options.icon.type?f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a.base[b.usermap]+this._options.icon.path):f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this._options.icon.path);f.setAttribute("x",this._options.icon.anchorx);f.setAttribute("y",this._options.icon.anchory);f.setAttribute("width",this._options.icon.width);f.setAttribute("height",this._options.icon.height);d.setAttribute("transform","scale(1,-1)");if(""!=this._options.label.text){f=p("text");
this.appendChild(f);var g=document.createTextNode(this._options.label.text);f.appendChild(g);f.setAttribute("style","stroke-width:0;pointer-events:none");f.style.strokeOpacity=0;f.style.fontFamily=this._options.label.style.fontFamily;f.style.fill=this._options.label.style.fontColor;f.style.fontSize=this._options.label.style.fontSize;f.style.fontStyle="undefined"!==typeof this._options.label.style.fontStyle?this._options.label.style.fontStyle:"normal";f.style.fontWeight="undefined"!==typeof this._options.label.style.fontWeight?
this._options.label.style.fontWeight:"normal";var g="middle",e=0,h=0;switch(this._options.label.position){case "right":g="start";e=d.getBBox().width/2+parseInt(this._options.label.offsetX);h=parseInt(f.style.fontSize)/2-(f.getBBox().height+f.getBBox().y)/2+parseInt(this._options.label.offsetY);break;case "top":g="middle";e=0+parseInt(this._options.label.offsetX);h=-d.getBBox().height/2-(f.getBBox().height+f.getBBox().y)/2+parseInt(this._options.label.offsetY);break;case "left":g="end";e=d.getBBox().x+
parseInt(this._options.label.offsetX);h=parseInt(f.style.fontSize)/2-(f.getBBox().height+f.getBBox().y)/2+parseInt(this._options.label.offsetY);break;case "bottom":g="middle";e=0+parseInt(this._options.label.offsetX);h=d.getBBox().height/2+parseInt(f.style.fontSize)-(f.getBBox().height+f.getBBox().y)/2+parseInt(this._options.label.offsetY);break;case "center":g="middle",e=0+parseInt(this._options.label.offsetX),h=parseInt(f.style.fontSize)/2-(f.getBBox().height+f.getBBox().y)/2+parseInt(this._options.label.offsetY)}f.setAttribute("x",
e);f.setAttribute("y",h);f.setAttribute("transform","scale(1,-1)");f.setAttribute("text-anchor",g)}d=this._options.y;f=this._options.x;this._lat=d*(a.map[c].precision/a.factor[b.usermap]);this._lng=f*(a.map[c].precision/a.factor[b.usermap]);this.setAttribute("transform","translate("+k(f*(a.map[c].precision/a.factor[b.usermap]),a.precision)+","+k(d*(a.map[c].precision/a.factor[b.usermap]),a.precision)+") scale("+k(a.map[c].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};
g.onmouseover=function(d){if("marker"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&r(b,d,"<strong>[Click]</strong> to select or <strong>[Drag]</strong> to change position");if(!a.touchdevices&&"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.marker[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id].link&&(this.style.cursor="pointer"),"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=
typeof a.usermap[b.usermap].map.marker[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id].infobox&&!document.getElementById("imap5custom_"+b.usermap+"_infobox_marker_"+this._id))){var c={};c.clientX=d.clientX;c.clientY=d.clientY;c.obj="marker";c.infobox=a.usermap[b.usermap].map.marker[this._id].infobox;this.infobox=new u(b,this._id,c)}};g.onmouseout=function(d){if("marker"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&v(b);
"normal"==a.mode[b.usermap]&&(this.style.cursor="auto","onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id].infobox&&(null==d.relatedTarget||d.relatedTarget.id!="imap5custom_"+b.usermap+"_infobox_marker_"+this._id)&&document.getElementById("imap5custom_"+b.usermap+"_infobox_marker_"+this._id)&&this.infobox.remove())};g.onmousedown=function(d){d.preventDefault&&d.preventDefault();
"edit"==a.mode[b.usermap]&&(d.stopPropagation&&d.stopPropagation(),this._mousedown=!0,this._mapdragged=!1,this._x=d.clientX,this._y=d.clientY,a.selectedOverlay[b.usermap]=this)};g.onmousemove=function(d){d.preventDefault&&d.preventDefault();if("edit"==a.mode[b.usermap]&&(d.stopPropagation&&d.stopPropagation(),this._mousedown&&(2<Math.abs(d.clientX-this._x)||2<Math.abs(d.clientY-this._y)))){this._mapdragged=!0;this._x=d.clientX;this._y=d.clientY;var f=a.svgcoord[b.usermap];f.x=d.clientX;f.y=d.clientY;
f=s(f,a.g[b.usermap]);f.x/=a.map[c].precision/a.factor[b.usermap];f.y/=a.map[c].precision/a.factor[b.usermap];this._lat=f.y*(a.map[c].precision/a.factor[b.usermap]);this._lng=f.x*(a.map[c].precision/a.factor[b.usermap]);this.setAttribute("transform","translate("+k(this._lng,a.precision)+","+k(this._lat,a.precision)+") scale("+k(a.map[c].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")}"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?document.getElementById("imap5custom_"+
b.usermap+"_infobox_marker_"+this._id)&&this.infobox.hide():document.getElementById("imap5custom_"+b.usermap+"_infobox_marker_"+this._id)&&(this.infobox.reposition(d.clientX,d.clientY),this.infobox.show()))};g.onmouseup=function(d){d.preventDefault&&d.preventDefault();"edit"==a.mode[b.usermap]&&(d.stopPropagation&&d.stopPropagation(),a.selectedOverlay[b.usermap]==this&&(a.selectedOverlay[b.usermap]=null),d={event:"poschange",object:"marker"},d.id=Number(this._id),d.y=k(this._lat/(a.map[c].precision/
a.factor[b.usermap]),a.precision),d.x=k(this._lng/(a.map[c].precision/a.factor[b.usermap]),a.precision),window.console&&console.log(JSON.stringify(d)),this._mousedown=!1)};g.onclick=function(d){this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||("edit"==a.mode[b.usermap]?(d={event:"click",object:"marker"},d.id=Number(this._id),window.console&&console.log(JSON.stringify(d))):"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.marker[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id].link)&&
("undefined"==typeof a.usermap[b.usermap].map.marker[this._id].link_target?location.href=a.usermap[b.usermap].map.marker[this._id].link:window.open(a.usermap[b.usermap].map.marker[this._id].link,a.usermap[b.usermap].map.marker[this._id].link_target)))};a.touchdevices&&(g.ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},g.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-
this._posX)||10<Math.abs(a.touches[0].clientY-this._posY))&&(this._move=!0):this._touch=!1},g.ontouchend=function(d){if(this._touch&&!this._move&&!a.div[b.usermap]._mapdragged){if("edit"==a.mode[b.usermap]){d={event:"click",object:"marker"};d.id=this._id;window.console&&console.log(JSON.stringify(d));return}"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.marker[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.marker[this._id].link_target?
location.href=a.usermap[b.usermap].map.marker[this._id].link:window.open(a.usermap[b.usermap].map.marker[this._id].link,a.usermap[b.usermap].map.marker[this._id].link_target));if("edit"==a.mode[b.usermap])return;0<a.infobox[b.usermap].length&&(document.getElementById("imap5custom_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5custom_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),
a.infobox[b.usermap].pop());"undefined"==typeof a.usermap[b.usermap].map.marker[this._id]||("undefined"==typeof a.usermap[b.usermap].map.marker[this._id].infobox||document.getElementById("imap5custom_"+b.usermap+"_infobox_marker_"+this._id))||(d={},d.clientX=this._posX,d.clientY=this._posY,d.obj="marker",d.infobox=a.usermap[b.usermap].map.marker[this._id].infobox,this.infobox=new u(b,this._id,d))}this._move=this._touch=!1});g.remove=function(){a.g[b.usermap].removeChild(this);a.marker[b.usermap][this._id]=
null};g.drawMarker();return g},L=function(b,f,h){var c=a.usermap[b.usermap].map.id,g=p("g");a.g[b.usermap].appendChild(g);g._options=h;g._id=f;g.setAttribute("id","imap5custom_"+b.usermap+"_maplabel_"+f);g._lat=h.y;g._lng=h.x;g._dx=g._lng*(a.map[c].precision/a.factor[b.usermap]);g._dy=parseFloat(g._lat)*(a.map[c].precision/a.factor[b.usermap]);g._show=!0;g.setPosition=function(d){this._lat=a.usermap[b.usermap].map.maplabel[this._id].y=d.y;this._lng=a.usermap[b.usermap].map.maplabel[this._id].x=d.x;
this._dy=parseFloat(this._lat)*(a.map[c].precision/a.factor[b.usermap]);this._dx=this._lng*(a.map[c].precision/a.factor[b.usermap]);g.setAttribute("transform","translate("+k(this._dx,a.precision)+","+k(this._dy,a.precision)+") scale("+k(a.map[c].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};g.getPosition=function(){var a={};a.y=this._lat;a.x=this._lng;return a};g.setOptions=function(a){this._options=a};g.setLabel=function(a){this._options.label=a;this.drawMapLabel()};
g.hide=function(){this.style.visibility="hidden";this._show=!1};g.show=function(){this.style.visibility="visible";this._show=!0};g.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&a.usermap[b.usermap].map.categorylegend.enable?0!=this._options.categoryid&&("undefined"!=typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this._options.categoryid)?this.show():this.hide():this.show()):this.show():this.show()};
g.drawMapLabel=function(){var d=this.getElementsByTagName("text")[0];"undefined"!=typeof d&&this.removeChild(d);if(""!=this._options.label.text){d=p("text");this.appendChild(d);var f=document.createTextNode(this._options.label.text);d.appendChild(f);d.setAttribute("style","stroke-width:0");d.style.strokeOpacity=0;d.style.fontFamily=this._options.label.style.fontFamily;d.style.fill=this._options.label.style.fontColor;d.style.fontSize=this._options.label.style.fontSize;d.style.fontStyle=this._options.label.style.fontStyle;
d.style.fontWeight=this._options.label.style.fontWeight;"normal"==a.mode[b.usermap]&&(d.style.pointerEvents="none");f=0+parseInt(d.style.fontSize)/2-(d.getBBox().height+d.getBBox().y)/2;d.setAttribute("x",0);d.setAttribute("y",f);d.setAttribute("transform","scale(1,-1)");d.setAttribute("text-anchor","middle")}d=this._options.y;f=this._options.x;this._lat=d*(a.map[c].precision/a.factor[b.usermap]);this._lng=f*(a.map[c].precision/a.factor[b.usermap]);this.setAttribute("transform","translate("+k(f*(a.map[c].precision/
a.factor[b.usermap]),a.precision)+","+k(d*(a.map[c].precision/a.factor[b.usermap]),a.precision)+") scale("+k(a.map[c].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};g.onmouseover=function(d){if("maplabel"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&r(b,d,"<strong>[Click]</strong> to select or <strong>[Drag]</strong> to change position")};g.onmouseout=function(d){if("maplabel"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor=
"auto";"edit"==a.mode[b.usermap]&&v(b);"normal"==a.mode[b.usermap]&&(this.style.cursor="auto")};g.onmousedown=function(d){d.preventDefault&&d.preventDefault();"edit"==a.mode[b.usermap]&&(d.stopPropagation&&d.stopPropagation(),this._mousedown=!0,this._mapdragged=!1,this._x=d.clientX,this._y=d.clientY,a.selectedOverlay[b.usermap]=this)};g.onmousemove=function(d){d.preventDefault&&d.preventDefault();if("edit"==a.mode[b.usermap]&&(d.stopPropagation&&d.stopPropagation(),this._mousedown&&(2<Math.abs(d.clientX-
this._x)||2<Math.abs(d.clientY-this._y)))){this._mapdragged=!0;this._x=d.clientX;this._y=d.clientY;var f=a.svgcoord[b.usermap];f.x=d.clientX;f.y=d.clientY;f=s(f,a.g[b.usermap]);f.x/=a.map[c].precision/a.factor[b.usermap];f.y/=a.map[c].precision/a.factor[b.usermap];this._lat=f.y*(a.map[c].precision/a.factor[b.usermap]);this._lng=f.x*(a.map[c].precision/a.factor[b.usermap]);this.setAttribute("transform","translate("+k(this._lng,a.precision)+","+k(this._lat,a.precision)+") scale("+k(a.map[c].precision/
a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")}};g.onmouseup=function(d){d.preventDefault&&d.preventDefault();"edit"==a.mode[b.usermap]&&(d.stopPropagation&&d.stopPropagation(),a.selectedOverlay[b.usermap]==this&&(a.selectedOverlay[b.usermap]=null),d={event:"poschange",object:"maplabel"},d.id=Number(this._id),d.y=k(this._lat/(a.map[c].precision/a.factor[b.usermap]),a.precision),d.x=k(this._lng/(a.map[c].precision/a.factor[b.usermap]),a.precision),window.console&&console.log(JSON.stringify(d)),
this._mousedown=!1)};g.onclick=function(d){this._mapdragged||this._transformed||"edit"!=a.mode[b.usermap]||(d={event:"click",object:"maplabel"},d.id=Number(this._id),window.console&&console.log(JSON.stringify(d)))};a.touchdevices&&(g.ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},g.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||10<Math.abs(a.touches[0].clientY-
this._posY))&&(this._move=!0):this._touch=!1},g.ontouchend=function(d){!this._touch||(this._move||a.div[b.usermap]._mapdragged)||"edit"!=a.mode[b.usermap]?this._move=this._touch=!1:(d={event:"click",object:"maplabel"},d.id=this._id,window.console&&console.log(JSON.stringify(d)))});g.remove=function(){a.g[b.usermap].removeChild(this);a.maplabel[b.usermap][this._id]=null};g.drawMapLabel();return g},C=function(b,f,h){var c=a.usermap[b.usermap].map.id,g=p("g");a.g[b.usermap].appendChild(g);g._options=
h;g._id=f;g.setAttribute("id","imap5custom_"+b.usermap+"_mappath_"+f);g._show=!0;g._points=h.points;g._movingpoints="";g._mainvertices=[];g._subvertices=[];g.updateVertices=function(b,c,f){var e=this._points.split(" ");e[b-1]=k(c,a.precision)+","+k(f,a.precision);b="";for(c=0;c<e.length;c++)""!=b&&(b+=" "),b=b+e[c].split(",")[0]+","+e[c].split(",")[1];this._points=this._options.points=b;this.drawMapPath()};g.addVertices=function(b,c,f){for(var e=this._points.split(" "),g="",h=0;h<e.length;h++)""!=
g&&(g+=" "),h==b&&(g=g+k(c,a.precision)+","+k(f,a.precision)+" "),g=g+e[h].split(",")[0]+","+e[h].split(",")[1];this._points=this._options.points=g;this.drawMapPath();this.postPosChange()};g.removeVertices=function(a){var b=this._points.split(" ");if(2<b.length){for(var c="",e=0;e<b.length;e++)e!=a-1&&(""!=c&&(c+=" "),c=c+b[e].split(",")[0]+","+b[e].split(",")[1]);this._points=this._options.points=c;this.drawMapPath();this.postPosChange()}};g.postPosChange=function(){this.createVertices();var a={event:"poschange",
object:"mappath"};a.id=Number(this._id);a.points=this._points;window.console&&console.log(JSON.stringify(a))};g.setPosition=function(d){this._points=a.usermap[b.usermap].map.mappath[this._id].points=d.points;this.drawMapPath()};g.getPosition=function(){var a={};a.points=this._points;return a};g.setOptions=function(a){this._options=a};g.addPoint=function(a,b){var c=this._options.points;this._options.points=this._points=c+" "+a+","+b;this.drawMapPath()};g.hide=function(){this.style.visibility="hidden";
this._show=!1};g.show=function(){this.style.visibility="visible";this._show=!0};g.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&a.usermap[b.usermap].map.categorylegend.enable?0!=this._options.categoryid&&("undefined"!=typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this._options.categoryid)?this.show():this.hide():this.show()):this.show():this.show()};g.drawMapPath=function(){var d=this.getElementsByTagName("polyline")[0];
"undefined"!=typeof d&&this.removeChild(d);d=p("polyline");this.appendChild(d);d.setAttribute("fill","none");d.setAttribute("stroke",this._options.style.stroke);d.setAttribute("stroke-width",k(this._options.style.strokeWidth/a.zoom[b.usermap].currentzoom*(a.map[c].precision/a.factor[b.usermap]),a.precision));if("undefined"!=typeof this._options.style.strokeDasharray&&"none"!==this._options.style.strokeDasharray){for(var f=this._options.style.strokeDasharray.split(","),g="",e=0;e<f.length;e++)""!=
g&&(g+=","),g+=k(f[e]/a.zoom[b.usermap].currentzoom*(a.map[c].precision/a.factor[b.usermap]),a.precision);d.setAttribute("stroke-dasharray",g)}for(var f=this._options.points.split(" "),g="",h,q,e=0;e<f.length;e++)""!=g&&(g+=" "),h=f[e].split(","),q=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),h=h[1]*(a.map[c].precision/a.factor[b.usermap]),g=g+k(h,a.precision)+","+k(q,a.precision);""!=this._movingpoints&&(h=this._movingpoints.split(","),q=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),
h=h[1]*(a.map[c].precision/a.factor[b.usermap]),""!=g&&(g+=" "),g=g+k(h,a.precision)+","+k(q,a.precision));d.setAttribute("points",g);d.setAttribute("stroke-opacity",this._options.style.strokeOpacity);d.setAttribute("stroke-linejoin","round")};g.onmouseover=function(d){if("mappath"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&r(b,d,"Click to select");if(!a.touchdevices&&"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id]&&
"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id].link&&(this.style.cursor="pointer"),"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id].infobox&&!document.getElementById("imap5custom_"+b.usermap+"_infobox_mappath_"+this._id))){var c={};c.clientX=d.clientX;c.clientY=d.clientY;c.obj="mappath";c.infobox=a.usermap[b.usermap].map.mappath[this._id].infobox;this.infobox=
new u(b,this._id,c)}};g.onmouseout=function(d){if("mappath"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&v(b);"normal"==a.mode[b.usermap]&&(this.style.cursor="auto","onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id].infobox&&(null==d.relatedTarget||d.relatedTarget.id!="imap5custom_"+b.usermap+"_infobox_mappath_"+this._id)&&
document.getElementById("imap5custom_"+b.usermap+"_infobox_mappath_"+this._id)&&this.infobox.remove())};g.onmousemove=function(d){d.preventDefault&&d.preventDefault();"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?document.getElementById("imap5custom_"+b.usermap+"_infobox_mappath_"+this._id)&&this.infobox.hide():document.getElementById("imap5custom_"+b.usermap+"_infobox_mappath_"+this._id)&&(this.infobox.reposition(d.clientX,d.clientY),this.infobox.show()))};g.createVertices=function(){null!=
a.selectedVerticesObj[b.usermap]&&a.selectedVerticesObj[b.usermap]!=this&&a.selectedVerticesObj[b.usermap].deleteVertices();a.selectedVerticesObj[b.usermap]=this;for(var d in this._mainvertices)this._mainvertices.hasOwnProperty(d)&&this._mainvertices[d].remove();this._mainvertices.length=0;for(var c in this._subvertices)this._subvertices.hasOwnProperty(c)&&this._subvertices[c].remove();this._subvertices.length=0;var f=this._points.split(" "),e={};for(d=0;d<f.length;d++)c=f[d].split(","),e.lat=c[0],
e.lng=c[1],e.type=0,e.removable=!0,this._mainvertices[d+1]=new y(b,d+1,this,e),e={};var g,e={};for(c=0;c<f.length-1;c++){d=f[c].split(",");g=f[c+1].split(",");var h=e,p;p=(parseFloat(d[0])+parseFloat(g[0]))/2;p=parseFloat(p);h.lat=k(p,a.precision);e.lng=k((parseFloat(d[1])+parseFloat(g[1]))/2,a.precision);e.type=1;e.removable=!1;this._subvertices[c+1]=new y(b,c+1,this,e);e={}}};g.deleteVertices=function(){for(var a in this._mainvertices)this._mainvertices.hasOwnProperty(a)&&this._mainvertices[a].remove();
this._mainvertices.length=0;for(var b in this._subvertices)this._subvertices.hasOwnProperty(b)&&this._subvertices[b].remove();this._subvertices.length=0};g.hideSubVertices=function(){for(var a in this._subvertices)this._subvertices.hasOwnProperty(a)&&this._subvertices[a].hide()};g.showSubVertices=function(){for(var a in this._subvertices)this._subvertices.hasOwnProperty(a)&&this._subvertices[a].show()};g.onclick=function(d){this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||("edit"==
a.mode[b.usermap]?(this.createVertices(),d={event:"click",object:"mappath"},d.id=Number(this._id),window.console&&console.log(JSON.stringify(d))):"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id].link)&&("undefined"==typeof a.usermap[b.usermap].map.mappath[this._id].link_target?location.href=a.usermap[b.usermap].map.mappath[this._id].link:window.open(a.usermap[b.usermap].map.mappath[this._id].link,
a.usermap[b.usermap].map.mappath[this._id].link_target)))};a.touchdevices&&(g.ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},g.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||10<Math.abs(a.touches[0].clientY-this._posY))&&(this._move=!0):this._touch=!1},g.ontouchend=function(d){if(this._touch&&!this._move&&!a.div[b.usermap]._mapdragged){if("edit"==
a.mode[b.usermap]){d={event:"click",object:"mappath"};d.id=this._id;window.console&&console.log(JSON.stringify(d));return}"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappath[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.mappath[this._id].link_target?location.href=a.usermap[b.usermap].map.mappath[this._id].link:window.open(a.usermap[b.usermap].map.mappath[this._id].link,a.usermap[b.usermap].map.mappath[this._id].link_target));
if("edit"==a.mode[b.usermap])return;0<a.infobox[b.usermap].length&&(document.getElementById("imap5custom_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5custom_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),a.infobox[b.usermap].pop());"undefined"==typeof a.usermap[b.usermap].map.mappath[this._id]||("undefined"==typeof a.usermap[b.usermap].map.mappath[this._id].infobox||
document.getElementById("imap5custom_"+b.usermap+"_infobox_mappath_"+this._id))||(d={},d.clientX=this._posX,d.clientY=this._posY,d.obj="mappath",d.infobox=a.usermap[b.usermap].map.mappath[this._id].infobox,this.infobox=new u(b,this._id,d))}this._move=this._touch=!1});g.remove=function(){for(var d in this._mainvertices)this._mainvertices.hasOwnProperty(d)&&this._mainvertices[d].remove();for(d in this._subvertices)this._subvertices.hasOwnProperty(d)&&this._subvertices[d].remove();a.g[b.usermap].removeChild(this);
a.mappath[b.usermap][this._id]=null};g.drawMapPath();return g},D=function(b,f,h){var c=a.usermap[b.usermap].map.id,g=p("g");a.g[b.usermap].appendChild(g);g._options=h;g._id=f;g.setAttribute("id","imap5custom_"+b.usermap+"_mappoly_"+f);g._points=h.points;g._movingpoints="";g._mainvertices=[];g._subvertices=[];g.ishighlight=!1;g._show=!0;g.updateVertices=function(b,c,f){var e=this._points.split(" ");e[b-1]=k(c,a.precision)+","+k(f,a.precision);b="";for(c=0;c<e.length;c++)""!=b&&(b+=" "),b=b+e[c].split(",")[0]+
","+e[c].split(",")[1];this._points=this._options.points=b;this.drawMapPoly()};g.addVertices=function(b,c,f){for(var e=this._points.split(" "),g="",h=0;h<e.length;h++)""!=g&&(g+=" "),h==b&&(g=g+k(c,a.precision)+","+k(f,a.precision)+" "),g=g+e[h].split(",")[0]+","+e[h].split(",")[1];b==e.length&&(""!=g&&(g+=" "),g=g+k(c,a.precision)+","+k(f,a.precision));this._points=this._options.points=g;this.drawMapPoly();this.postPosChange()};g.removeVertices=function(a){var b=this._points.split(" ");if(3<b.length){for(var c=
"",e=0;e<b.length;e++)e!=a-1&&(""!=c&&(c+=" "),c=c+b[e].split(",")[0]+","+b[e].split(",")[1]);this._points=this._options.points=c;this.drawMapPoly();this.postPosChange()}};g.postPosChange=function(){this.createVertices();var a={event:"poschange",object:"mappoly"};a.id=Number(this._id);a.points=this._points;window.console&&console.log(JSON.stringify(a))};g.setPosition=function(d){this._points=a.usermap[b.usermap].map.mappoly[this._id].points=d.points;this.drawMapPoly()};g.getPosition=function(){var a=
{};a.points=this._points;return a};g.setOptions=function(a){this._options=a};g.addPoint=function(a,b){var c=this._options.points;this._options.points=this._points=c+" "+a+","+b;this.drawMapPoly()};g.hide=function(){this.style.visibility="hidden";this._show=!1};g.show=function(){this.style.visibility="visible";this._show=!0};g.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&a.usermap[b.usermap].map.categorylegend.enable?0!=this._options.categoryid&&
("undefined"!=typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this._options.categoryid)?this.show():this.hide():this.show()):this.show():this.show()};g.count=function(){return this._options.points.split(" ").length};g.drawMapPoly=function(){var d=this.getElementsByTagName("polygon")[0];"undefined"!=typeof d&&this.removeChild(d);d=this.getElementsByTagName("polyline")[0];"undefined"!=typeof d&&this.removeChild(d);d=1>=this.count()?p("polyline"):p("polygon");this.appendChild(d);
d.setAttribute("fill",this._options.fill);d.setAttribute("fill-opacity",this._options.fillOpacity);d.setAttribute("stroke",this._options.style.stroke);d.setAttribute("stroke-width",k(this._options.style.strokeWidth/a.zoom[b.usermap].currentzoom*(a.map[c].precision/a.factor[b.usermap]),a.precision));if("undefined"!=typeof this._options.style.strokeDasharray&&"none"!==this._options.style.strokeDasharray){for(var f=this._options.style.strokeDasharray.split(","),g="",e=0;e<f.length;e++)""!=g&&(g+=","),
g+=k(f[e]/a.zoom[b.usermap].currentzoom*(a.map[c].precision/a.factor[b.usermap]),a.precision);d.setAttribute("stroke-dasharray",g)}for(var f=this._options.points.split(" "),g="",h,q,e=0;e<f.length;e++)""!=g&&(g+=" "),h=f[e].split(","),q=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),h=h[1]*(a.map[c].precision/a.factor[b.usermap]),g=g+k(h,a.precision)+","+k(q,a.precision);""!=this._movingpoints&&(h=this._movingpoints.split(","),q=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),
h=h[1]*(a.map[c].precision/a.factor[b.usermap]),""!=g&&(g+=" "),g=g+k(h,a.precision)+","+k(q,a.precision));d.setAttribute("points",g);d.setAttribute("stroke-opacity",this._options.style.strokeOpacity);d.setAttribute("stroke-linejoin","round")};a.touchdevices||(g.onmouseover=function(d){if("mappoly"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&(r(b,d,"Click to select"),this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fillHighlight),
this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillHighlightOpacity));if(!a.touchdevices&&"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id].link&&(this.style.cursor="pointer"),this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fillHighlight),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillHighlightOpacity),
"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id].infobox&&!document.getElementById("imap5custom_"+b.usermap+"_infobox_mappoly_"+this._id))){var c={};c.clientX=d.clientX;c.clientY=d.clientY;c.obj="mappoly";c.infobox=a.usermap[b.usermap].map.mappoly[this._id].infobox;this.infobox=new u(b,this._id,c)}});a.touchdevices||(g.onmouseout=function(d){if("mappoly"==a.mode[b.usermap]||
"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&(v(b),this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillOpacity));"normal"==a.mode[b.usermap]&&(this.style.cursor="auto",this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillOpacity),"onmouseover"==
a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id].infobox&&(null==d.relatedTarget||d.relatedTarget.id!="imap5custom_"+b.usermap+"_infobox_mappoly_"+this._id)&&document.getElementById("imap5custom_"+b.usermap+"_infobox_mappoly_"+this._id)&&this.infobox.remove())});g.onmousemove=function(d){d.preventDefault&&d.preventDefault();"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?document.getElementById("imap5custom_"+
b.usermap+"_infobox_mappoly_"+this._id)&&this.infobox.hide():document.getElementById("imap5custom_"+b.usermap+"_infobox_mappoly_"+this._id)&&(this.infobox.reposition(d.clientX,d.clientY),this.infobox.show()))};g.createVertices=function(){null!=a.selectedVerticesObj[b.usermap]&&a.selectedVerticesObj[b.usermap]!=this&&a.selectedVerticesObj[b.usermap].deleteVertices();a.selectedVerticesObj[b.usermap]=this;for(var d in this._mainvertices)this._mainvertices.hasOwnProperty(d)&&this._mainvertices[d].remove();
this._mainvertices.length=0;for(var c in this._subvertices)this._subvertices.hasOwnProperty(d)&&this._subvertices[c].remove();this._subvertices.length=0;var f=this._points.split(" "),e={};for(d=0;d<f.length;d++)c=f[d].split(","),e.lat=c[0],e.lng=c[1],e.type=0,e.removable=!0,this._mainvertices[d+1]=new y(b,d+1,this,e),e={};var g,e={};for(c=0;c<f.length-1;c++)d=f[c].split(","),g=f[c+1].split(","),e.lat=k((parseFloat(d[0])+parseFloat(g[0]))/2,a.precision),e.lng=k((parseFloat(d[1])+parseFloat(g[1]))/
2,a.precision),e.type=1,e.removable=!1,this._subvertices[c+1]=new y(b,c+1,this,e),e={};c=f.length-1;d=f[c].split(",");g=f[0].split(",");e.lat=k((parseFloat(d[0])+parseFloat(g[0]))/2,a.precision);e.lng=k((parseFloat(d[1])+parseFloat(g[1]))/2,a.precision);e.type=1;e.removable=!1;this._subvertices[c+1]=new y(b,c+1,this,e)};g.deleteVertices=function(){for(var a in this._mainvertices)this._mainvertices.hasOwnProperty(a)&&this._mainvertices[a].remove();this._mainvertices.length=0;for(var b in this._subvertices)this._subvertices.hasOwnProperty(b)&&
this._subvertices[b].remove();this._subvertices.length=0};g.hideSubVertices=function(){for(var a in this._subvertices)this._subvertices.hasOwnProperty(a)&&this._subvertices[a].hide()};g.showSubVertices=function(){for(var a in this._subvertices)this._subvertices.hasOwnProperty(a)&&this._subvertices[a].show()};g.onclick=function(d){this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||("edit"==a.mode[b.usermap]?(this.createVertices(),d={event:"click",object:"mappoly"},d.id=Number(this._id),
window.console&&console.log(JSON.stringify(d))):"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id].link)&&("undefined"==typeof a.usermap[b.usermap].map.mappoly[this._id].link_target?location.href=a.usermap[b.usermap].map.mappoly[this._id].link:window.open(a.usermap[b.usermap].map.mappoly[this._id].link,a.usermap[b.usermap].map.mappoly[this._id].link_target)))};a.touchdevices&&(g.ontouchstart=
function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},g.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||10<Math.abs(a.touches[0].clientY-this._posY))&&(this._move=!0):this._touch=!1},g.ontouchend=function(d){if(this._touch&&!this._move&&!a.div[b.usermap]._mapdragged){if("edit"==a.mode[b.usermap]){d={event:"click",object:"mappoly"};d.id=this._id;window.console&&console.log(JSON.stringify(d));
return}"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mappoly[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.mappoly[this._id].link_target?location.href=a.usermap[b.usermap].map.mappoly[this._id].link:window.open(a.usermap[b.usermap].map.mappoly[this._id].link,a.usermap[b.usermap].map.mappoly[this._id].link_target));if("edit"==a.mode[b.usermap])return;this.ishighlight?(this.ishighlight=!1,this.getElementsByTagName("polygon")[0].setAttribute("fill",
this._options.fill),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillOpacity)):(this.ishighlight=!0,this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fillHighlight),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillHighlightOpacity));0<a.infobox[b.usermap].length&&(document.getElementById("imap5custom_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5custom_"+
b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),a.infobox[b.usermap].pop());"undefined"==typeof a.usermap[b.usermap].map.mappoly[this._id]||("undefined"==typeof a.usermap[b.usermap].map.mappoly[this._id].infobox||document.getElementById("imap5custom_"+b.usermap+"_infobox_mappoly_"+this._id))||(d={},d.clientX=this._posX,d.clientY=this._posY,d.obj="mappoly",d.infobox=a.usermap[b.usermap].map.mappoly[this._id].infobox,this.infobox=new u(b,this._id,d))}this._move=
this._touch=!1});g.remove=function(){for(var d in this._mainvertices)this._mainvertices.hasOwnProperty(d)&&this._mainvertices[d].remove();for(d in this._subvertices)this._subvertices.hasOwnProperty(d)&&this._subvertices[d].remove();a.g[b.usermap].removeChild(this);a.mappoly[b.usermap][this._id]=null};g.drawMapPoly();return g},E=function(b,f,h){var c=a.usermap[b.usermap].map.id,g=p("g");a.g[b.usermap].appendChild(g);g._options=h;g._id=f;g.setAttribute("id","imap5custom_"+b.usermap+"_mapcircle_"+f);
g._points=h.points;g._movingpoints="";g._mainvertices=[];g.ishighlight=!1;g._show=!0;g.setOptions=function(a){this._options=a};g.hide=function(){this.style.visibility="hidden";this._show=!1};g.show=function(){this.style.visibility="visible";this._show=!0};g.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&a.usermap[b.usermap].map.categorylegend.enable?0!=this._options.categoryid&&("undefined"!=typeof a.categorylegend[b.usermap]?-1!=
a.categorylegend[b.usermap].visiblelist.indexOf(this._options.categoryid)?this.show():this.hide():this.show()):this.show():this.show()};g.createVertices=function(){null!=a.selectedVerticesObj[b.usermap]&&a.selectedVerticesObj[b.usermap]!=this&&a.selectedVerticesObj[b.usermap].deleteVertices();a.selectedVerticesObj[b.usermap]=this;for(var d in this._mainvertices)this._mainvertices.hasOwnProperty(d)&&this._mainvertices[d].remove();this._mainvertices.length=0;var c=this._points.split(" "),f,e={};for(d=
0;d<c.length;d++)f=c[d].split(","),e.lat=f[0],e.lng=f[1],e.type=0,e.removable=!1,this._mainvertices[d+1]=new y(b,d+1,this,e),e={}};g.deleteVertices=function(){for(var a in this._mainvertices)this._mainvertices.hasOwnProperty(a)&&this._mainvertices[a].remove();this._mainvertices.length=0};g.postPosChange=function(){this.createVertices();var a={event:"poschange",object:"mapcircle"};a.id=Number(this._id);a.points=this._points;window.console&&console.log(JSON.stringify(a))};g.updateVertices=function(b,
c,f){var e=this._points.split(" "),g=e[0].split(","),h=e[1].split(",");e[b-1]=k(c,a.precision)+","+k(f,a.precision);1==b&&(e[b]=k(parseFloat(h[0])+(c-parseFloat(g[0])),a.precision)+","+k(parseFloat(h[1])+(f-parseFloat(g[1])),a.precision),b={},b.lat=k(parseFloat(h[0])+(c-parseFloat(g[0])),a.precision),b.lng=k(parseFloat(h[1])+(f-parseFloat(g[1])),a.precision),b.type=0,b.removable=!1,this._mainvertices[2].setOptions(b),this._mainvertices[2].drawVerticesObj());c="";for(f=0;f<e.length;f++)""!=c&&(c+=
" "),c=c+e[f].split(",")[0]+","+e[f].split(",")[1];this._points=this._options.points=c;this.drawMapCircle()};g.hideSubVertices=function(){};g.showSubVertices=function(){};g.drawMapCircle=function(){var d=this.getElementsByTagName("circle")[0];"undefined"!=typeof d&&this.removeChild(d);d=p("circle");this.appendChild(d);d.setAttribute("fill",this._options.fill);d.setAttribute("fill-opacity",this._options.fillOpacity);d.setAttribute("stroke",this._options.style.stroke);d.setAttribute("stroke-width",
k(this._options.style.strokeWidth/a.zoom[b.usermap].currentzoom*(a.map[c].precision/a.factor[b.usermap]),a.precision));if("undefined"!=typeof this._options.style.strokeDasharray&&"none"!==this._options.style.strokeDasharray){for(var f=this._options.style.strokeDasharray.split(","),g="",e=0;e<f.length;e++)""!=g&&(g+=","),g+=k(f[e]/a.zoom[b.usermap].currentzoom*(a.map[c].precision/a.factor[b.usermap]),a.precision);d.setAttribute("stroke-dasharray",g)}var f=this._options.points.split(" "),g="",h,q,r;
h=e="";var s={},m={};if(1==f.length)e=f[0].split(","),h=""==this._movingpoints?e:this._movingpoints.split(","),k(e[1]*(a.map[c].precision/a.factor[b.usermap]),a.precision),k(parseFloat(e[0])*(a.map[c].precision/a.factor[b.usermap]),a.precision),k(h[1]*(a.map[c].precision/a.factor[b.usermap]),a.precision),k(parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),a.precision),s.x=k(e[1]*(a.map[c].precision/a.factor[b.usermap]),a.precision),s.y=k(parseFloat(e[0])*(a.map[c].precision/a.factor[b.usermap]),
a.precision),m.x=k(h[1]*(a.map[c].precision/a.factor[b.usermap]),a.precision),m.y=k(parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),a.precision);else for(e=0;e<f.length;e++)""!=g&&(g+=" "),h=f[e].split(","),r=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),q=h[1]*(a.map[c].precision/a.factor[b.usermap]),g=g+k(q,a.precision)+","+k(r,a.precision),0==e?(s.x=k(h[1]*(a.map[c].precision/a.factor[b.usermap]),a.precision),s.y=k(parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),
a.precision)):(m.x=k(h[1]*(a.map[c].precision/a.factor[b.usermap]),a.precision),m.y=k(parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),a.precision));d.setAttribute("cx",s.x);d.setAttribute("cy",s.y);d.setAttribute("r",H(s,m));d.setAttribute("stroke-opacity",this._options.style.strokeOpacity);d.setAttribute("stroke-linejoin","round")};g.onclick=function(d){this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||("edit"==a.mode[b.usermap]?(this.createVertices(),d={event:"click",
object:"mapcircle"},d.id=Number(this._id),window.console&&console.log(JSON.stringify(d))):"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.mapcircle[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcircle[this._id].link)&&("undefined"==typeof a.usermap[b.usermap].map.mapcircle[this._id].link_target?location.href=a.usermap[b.usermap].map.mapcircle[this._id].link:window.open(a.usermap[b.usermap].map.mapcircle[this._id].link,a.usermap[b.usermap].map.mapcircle[this._id].link_target)))};
a.touchdevices||(g.onmouseover=function(d){if("mapcircle"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&(r(b,d,"Click to select"),this.getElementsByTagName("circle")[0].setAttribute("fill",this._options.fillHighlight),this.getElementsByTagName("circle")[0].setAttribute("fill-opacity",this._options.fillHighlightOpacity));if(!a.touchdevices&&"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.mapcircle[this._id]&&"undefined"!=
typeof a.usermap[b.usermap].map.mapcircle[this._id].link&&(this.style.cursor="pointer"),this.getElementsByTagName("circle")[0].setAttribute("fill",this._options.fillHighlight),this.getElementsByTagName("circle")[0].setAttribute("fill-opacity",this._options.fillHighlightOpacity),"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mapcircle[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcircle[this._id].infobox&&!document.getElementById("imap5custom_"+
b.usermap+"_infobox_mapcircle_"+this._id))){var c={};c.clientX=d.clientX;c.clientY=d.clientY;c.obj="mapcircle";c.infobox=a.usermap[b.usermap].map.mapcircle[this._id].infobox;this.infobox=new u(b,this._id,c)}});a.touchdevices||(g.onmouseout=function(d){if("mapcircle"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&(v(b),this.getElementsByTagName("circle")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("circle")[0].setAttribute("fill-opacity",
this._options.fillOpacity));"normal"==a.mode[b.usermap]&&(this.style.cursor="auto",this.getElementsByTagName("circle")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("circle")[0].setAttribute("fill-opacity",this._options.fillOpacity),"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mapcircle[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcircle[this._id].infobox&&(null==d.relatedTarget||d.relatedTarget.id!="imap5custom_"+
b.usermap+"_infobox_mapcircle_"+this._id)&&document.getElementById("imap5custom_"+b.usermap+"_infobox_mapcircle_"+this._id)&&this.infobox.remove())});g.onmousemove=function(d){d.preventDefault&&d.preventDefault();"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?document.getElementById("imap5custom_"+b.usermap+"_infobox_mapcircle_"+this._id)&&this.infobox.hide():document.getElementById("imap5custom_"+b.usermap+"_infobox_mapcircle_"+this._id)&&(this.infobox.reposition(d.clientX,d.clientY),
this.infobox.show()))};a.touchdevices&&(g.ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},g.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||10<Math.abs(a.touches[0].clientY-this._posY))&&(this._move=!0):this._touch=!1},g.ontouchend=function(d){if(this._touch&&!this._move&&!a.div[b.usermap]._mapdragged){if("edit"==a.mode[b.usermap]){d={event:"click",
object:"mapcircle"};d.id=this._id;window.console&&console.log(JSON.stringify(d));return}"undefined"!=typeof a.usermap[b.usermap].map.mapcircle[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcircle[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.mapcircle[this._id].link_target?location.href=a.usermap[b.usermap].map.mapcircle[this._id].link:window.open(a.usermap[b.usermap].map.mapcircle[this._id].link,a.usermap[b.usermap].map.mapcircle[this._id].link_target));if("edit"==a.mode[b.usermap])return;
this.ishighlight?(this.ishighlight=!1,this.getElementsByTagName("circle")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("circle")[0].setAttribute("fill-opacity",this._options.fillOpacity)):(this.ishighlight=!0,this.getElementsByTagName("circle")[0].setAttribute("fill",this._options.fillHighlight),this.getElementsByTagName("circle")[0].setAttribute("fill-opacity",this._options.fillHighlightOpacity));0<a.infobox[b.usermap].length&&(document.getElementById("imap5custom_"+b.usermap+
"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5custom_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),a.infobox[b.usermap].pop());"undefined"==typeof a.usermap[b.usermap].map.mapcircle[this._id]||("undefined"==typeof a.usermap[b.usermap].map.mapcircle[this._id].infobox||document.getElementById("imap5custom_"+b.usermap+"_infobox_mapcircle_"+this._id))||(d={},d.clientX=this._posX,
d.clientY=this._posY,d.obj="mapcircle",d.infobox=a.usermap[b.usermap].map.mapcircle[this._id].infobox,this.infobox=new u(b,this._id,d))}this._move=this._touch=!1});g.remove=function(){for(var d in this._mainvertices)this._mainvertices.hasOwnProperty(d)&&this._mainvertices[d].remove();a.g[b.usermap].removeChild(this);a.mapcircle[b.usermap][this._id]=null};g.drawMapCircle();return g},F=function(b,f,h){var c=a.usermap[b.usermap].map.id,g=p("g");a.g[b.usermap].appendChild(g);g._options=h;g._id=f;g.setAttribute("id",
"imap5custom_"+b.usermap+"_maprect_"+f);g._points=h.points;g._movingpoints="";g._mainvertices=[];g.ishighlight=!1;g._show=!0;g.setOptions=function(a){this._options=a};g.hide=function(){this.style.visibility="hidden";this._show=!1};g.show=function(){this.style.visibility="visible";this._show=!0};g.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&a.usermap[b.usermap].map.categorylegend.enable?0!=this._options.categoryid&&("undefined"!=
typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this._options.categoryid)?this.show():this.hide():this.show()):this.show():this.show()};g.createVertices=function(){null!=a.selectedVerticesObj[b.usermap]&&a.selectedVerticesObj[b.usermap]!=this&&a.selectedVerticesObj[b.usermap].deleteVertices();a.selectedVerticesObj[b.usermap]=this;for(var d in this._mainvertices)this._mainvertices.hasOwnProperty(d)&&this._mainvertices[d].remove();this._mainvertices.length=0;var c=
this._points.split(" "),f,e={};for(d=0;d<c.length;d++)f=c[d].split(","),e.lat=f[0],e.lng=f[1],e.type=0,e.removable=!1,this._mainvertices[d+1]=new y(b,d+1,this,e),e={}};g.deleteVertices=function(){for(var a in this._mainvertices)this._mainvertices.hasOwnProperty(a)&&this._mainvertices[a].remove();this._mainvertices.length=0};g.postPosChange=function(){this.createVertices();var a={event:"poschange",object:"maprect"};a.id=Number(this._id);a.points=this._points;window.console&&console.log(JSON.stringify(a))};
g.updateVertices=function(b,c,f){var e=this._points.split(" ");e[b-1]=k(c,a.precision)+","+k(f,a.precision);e[b-1].split(",");var g=e[(b-1+2)%4].split(",");e[(b-1+1)%4]=k(g[0],a.precision)+","+k(f,a.precision);e[(b-1+2)%4]=k(g[0],a.precision)+","+k(g[1],a.precision);e[(b-1+3)%4]=k(c,a.precision)+","+k(g[1],a.precision);for(var h="",h="",p=0;p<e.length;p++)""!=h&&(h+=" "),h=h+e[p].split(",")[0]+","+e[p].split(",")[1];this._points=this._options.points=h;e={};e.lat=g[0];e.lng=f;e.type=0;e.removable=
!1;this._mainvertices[(b-1+1)%4+1].setOptions(e);this._mainvertices[(b-1+1)%4+1].drawVerticesObj();e={};e.lat=c;e.lng=g[1];e.type=0;e.removable=!1;this._mainvertices[(b-1+3)%4+1].setOptions(e);this._mainvertices[(b-1+3)%4+1].drawVerticesObj();this.drawMapRect()};g.hideSubVertices=function(){};g.showSubVertices=function(){};g.drawMapRect=function(){var d=this.getElementsByTagName("polygon")[0];"undefined"!=typeof d&&this.removeChild(d);d=p("polygon");this.appendChild(d);d.setAttribute("fill",this._options.fill);
d.setAttribute("fill-opacity",this._options.fillOpacity);d.setAttribute("stroke",this._options.style.stroke);d.setAttribute("stroke-width",k(this._options.style.strokeWidth/a.zoom[b.usermap].currentzoom*(a.map[c].precision/a.factor[b.usermap]),a.precision));if("undefined"!=typeof this._options.style.strokeDasharray&&"none"!==this._options.style.strokeDasharray){for(var f=this._options.style.strokeDasharray.split(","),g="",e=0;e<f.length;e++)""!=g&&(g+=","),g+=k(f[e]/a.zoom[b.usermap].currentzoom*
(a.map[c].precision/a.factor[b.usermap]),a.precision);d.setAttribute("stroke-dasharray",g)}var f=this._options.points.split(" "),g="",h,q;q=e="";if(1==f.length)e=f[0].split(","),q=""==this._movingpoints?e:this._movingpoints.split(","),g=g+k(e[1]*(a.map[c].precision/a.factor[b.usermap]),a.precision)+",",g=g+k(parseFloat(e[0])*(a.map[c].precision/a.factor[b.usermap]),a.precision)+" ",g=g+k(q[1]*(a.map[c].precision/a.factor[b.usermap]),a.precision)+",",g=g+k(parseFloat(e[0])*(a.map[c].precision/a.factor[b.usermap]),
a.precision)+" ",g=g+k(q[1]*(a.map[c].precision/a.factor[b.usermap]),a.precision)+",",g=g+k(parseFloat(q[0])*(a.map[c].precision/a.factor[b.usermap]),a.precision)+" ",g=g+k(e[1]*(a.map[c].precision/a.factor[b.usermap]),a.precision)+",",g+=k(parseFloat(q[0])*(a.map[c].precision/a.factor[b.usermap]),a.precision);else for(e=0;e<f.length;e++)""!=g&&(g+=" "),h=f[e].split(","),q=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),h=h[1]*(a.map[c].precision/a.factor[b.usermap]),g=g+k(h,a.precision)+
","+k(q,a.precision);d.setAttribute("points",g);d.setAttribute("stroke-opacity",this._options.style.strokeOpacity);d.setAttribute("stroke-linejoin","round")};g.onclick=function(d){this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||("edit"==a.mode[b.usermap]?(this.createVertices(),d={event:"click",object:"maprect"},d.id=Number(this._id),window.console&&console.log(JSON.stringify(d))):"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id]&&"undefined"!=
typeof a.usermap[b.usermap].map.maprect[this._id].link)&&("undefined"==typeof a.usermap[b.usermap].map.maprect[this._id].link_target?location.href=a.usermap[b.usermap].map.maprect[this._id].link:window.open(a.usermap[b.usermap].map.maprect[this._id].link,a.usermap[b.usermap].map.maprect[this._id].link_target)))};a.touchdevices||(g.onmouseover=function(d){if("maprect"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&(r(b,d,"Click to select"),this.getElementsByTagName("polygon")[0].setAttribute("fill",
this._options.fillHighlight),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillHighlightOpacity));if(!a.touchdevices&&"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id].link&&(this.style.cursor="pointer"),this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fillHighlight),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",
this._options.fillHighlightOpacity),"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id].infobox&&!document.getElementById("imap5custom_"+b.usermap+"_infobox_maprect_"+this._id))){var c={};c.clientX=d.clientX;c.clientY=d.clientY;c.obj="maprect";c.infobox=a.usermap[b.usermap].map.maprect[this._id].infobox;this.infobox=new u(b,this._id,c)}});a.touchdevices||(g.onmouseout=function(d){if("maprect"==
a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&(v(b),this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillOpacity));"normal"==a.mode[b.usermap]&&(this.style.cursor="auto",this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillOpacity),
"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id].infobox&&(null==d.relatedTarget||d.relatedTarget.id!="imap5custom_"+b.usermap+"_infobox_maprect_"+this._id)&&document.getElementById("imap5custom_"+b.usermap+"_infobox_maprect_"+this._id)&&this.infobox.remove())});g.onmousemove=function(d){d.preventDefault&&d.preventDefault();"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?
document.getElementById("imap5custom_"+b.usermap+"_infobox_maprect_"+this._id)&&this.infobox.hide():document.getElementById("imap5custom_"+b.usermap+"_infobox_maprect_"+this._id)&&(this.infobox.reposition(d.clientX,d.clientY),this.infobox.show()))};a.touchdevices&&(g.ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},g.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-
this._posX)||10<Math.abs(a.touches[0].clientY-this._posY))&&(this._move=!0):this._touch=!1},g.ontouchend=function(d){if(this._touch&&!this._move&&!a.div[b.usermap]._mapdragged){if("edit"==a.mode[b.usermap]){d={event:"click",object:"maprect"};d.id=this._id;window.console&&console.log(JSON.stringify(d));return}"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.maprect[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.maprect[this._id].link_target?
location.href=a.usermap[b.usermap].map.maprect[this._id].link:window.open(a.usermap[b.usermap].map.maprect[this._id].link,a.usermap[b.usermap].map.maprect[this._id].link_target));if("edit"==a.mode[b.usermap])return;this.ishighlight?(this.ishighlight=!1,this.getElementsByTagName("polygon")[0].setAttribute("fill",this._options.fill),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillOpacity)):(this.ishighlight=!0,this.getElementsByTagName("polygon")[0].setAttribute("fill",
this._options.fillHighlight),this.getElementsByTagName("polygon")[0].setAttribute("fill-opacity",this._options.fillHighlightOpacity));0<a.infobox[b.usermap].length&&(document.getElementById("imap5custom_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5custom_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),a.infobox[b.usermap].pop());"undefined"==typeof a.usermap[b.usermap].map.maprect[this._id]||
("undefined"==typeof a.usermap[b.usermap].map.maprect[this._id].infobox||document.getElementById("imap5custom_"+b.usermap+"_infobox_maprect_"+this._id))||(d={},d.clientX=this._posX,d.clientY=this._posY,d.obj="maprect",d.infobox=a.usermap[b.usermap].map.maprect[this._id].infobox,this.infobox=new u(b,this._id,d))}this._move=this._touch=!1});g.remove=function(){for(var d in this._mainvertices)this._mainvertices.hasOwnProperty(d)&&this._mainvertices[d].remove();a.g[b.usermap].removeChild(this);a.maprect[b.usermap][this._id]=
null};g.drawMapRect();return g},G=function(b,f,h){var c=a.usermap[b.usermap].map.id,g=p("g");a.g[b.usermap].appendChild(g);g._options=h;g._id=f;g.setAttribute("id","imap5custom_"+b.usermap+"_mapcurve_"+f);g._points=h.points;g._movingpoints="";g._mainvertices=[];g._show=!0;g.updateVertices=function(b,c,f){var e=this._points.split(" ");e[b-1]=k(c,a.precision)+","+k(f,a.precision);b="";for(c=0;c<e.length;c++)""!=b&&(b+=" "),b=b+e[c].split(",")[0]+","+e[c].split(",")[1];this._points=this._options.points=
b;this.drawMapCurve()};g.postPosChange=function(){this.createVertices();var a={event:"poschange",object:"mapcurve"};a.id=Number(this._id);a.points=this._points;window.console&&console.log(JSON.stringify(a))};g.setPosition=function(d){this._points=a.usermap[b.usermap].map.mapcurve[this._id].points=d.points;this.drawMapCurve()};g.getPosition=function(){var a={};a.points=this._points;return a};g.setOptions=function(a){this._options=a};g.count=function(){return this._options.points.split(" ").length};
g.addPoint=function(a,b){var c=this._options.points;this._options.points=this._points=c+" "+a+","+b;this.drawMapCurve()};g.hide=function(){this.style.visibility="hidden";this._show=!1};g.show=function(){this.style.visibility="visible";this._show=!0};g.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&a.usermap[b.usermap].map.categorylegend.enable?0!=this._options.categoryid&&("undefined"!=typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this._options.categoryid)?
this.show():this.hide():this.show()):this.show():this.show()};g.createVertices=function(){null!=a.selectedVerticesObj[b.usermap]&&a.selectedVerticesObj[b.usermap]!=this&&a.selectedVerticesObj[b.usermap].deleteVertices();a.selectedVerticesObj[b.usermap]=this;for(var d in this._mainvertices)this._mainvertices.hasOwnProperty(d)&&this._mainvertices[d].remove();this._mainvertices.length=0;var c=this._points.split(" "),f,e={};for(d=0;d<c.length;d++)f=c[d].split(","),e.lat=f[0],e.lng=f[1],e.type=0,e.removable=
!1,this._mainvertices[d+1]=new y(b,d+1,this,e),e={}};g.deleteVertices=function(){for(var a in this._mainvertices)this._mainvertices.hasOwnProperty(a)&&this._mainvertices[a].remove();this._mainvertices.length=0};g.hideSubVertices=function(){};g.showSubVertices=function(){};g.drawMapCurve=function(){var d=this.getElementsByTagName("path")[0];"undefined"!=typeof d&&this.removeChild(d);d=p("path");this.appendChild(d);d.setAttribute("fill","none");d.setAttribute("stroke",this._options.style.stroke);d.setAttribute("stroke-width",
k(this._options.style.strokeWidth/a.zoom[b.usermap].currentzoom*(a.map[c].precision/a.factor[b.usermap]),a.precision));if("undefined"!=typeof this._options.style.strokeDasharray&&"none"!==this._options.style.strokeDasharray){for(var f=this._options.style.strokeDasharray.split(","),g="",e=0;e<f.length;e++)""!=g&&(g+=","),g+=k(f[e]/a.zoom[b.usermap].currentzoom*(a.map[c].precision/a.factor[b.usermap]),a.precision);d.setAttribute("stroke-dasharray",g)}var f=this._options.points.split(" "),g="",h;1==
this.count()?(h=f[0].split(","),e=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),h=h[1]*(a.map[c].precision/a.factor[b.usermap]),g=g+"M"+k(h,a.precision)+","+k(e,a.precision),""!=this._movingpoints&&(h=this._movingpoints.split(","),e=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),h=h[1]*(a.map[c].precision/a.factor[b.usermap]),""!=g&&(g+=" L "),g=g+k(h,a.precision)+","+k(e,a.precision))):2==this.count()?(h=f[0].split(","),e=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),
h=h[1]*(a.map[c].precision/a.factor[b.usermap]),g=g+"M"+k(h,a.precision)+","+k(e,a.precision),""!=this._movingpoints&&(h=this._movingpoints.split(","),e=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),h=h[1]*(a.map[c].precision/a.factor[b.usermap]),""!=g&&(g+=" "),g=g+"Q "+k(h,a.precision)+","+k(e,a.precision)),h=f[1].split(","),e=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),h=h[1]*(a.map[c].precision/a.factor[b.usermap]),g=g+" "+k(h,a.precision)+","+k(e,a.precision)):3==this.count()&&
(h=f[0].split(","),e=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),h=h[1]*(a.map[c].precision/a.factor[b.usermap]),g=g+"M"+k(h,a.precision)+","+k(e,a.precision),""!=g&&(g+=" "),h=f[2].split(","),e=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),h=h[1]*(a.map[c].precision/a.factor[b.usermap]),g=g+"Q "+k(h,a.precision)+","+k(e,a.precision),""!=g&&(g+=" "),h=f[1].split(","),e=parseFloat(h[0])*(a.map[c].precision/a.factor[b.usermap]),h=h[1]*(a.map[c].precision/a.factor[b.usermap]),
g=g+k(h,a.precision)+","+k(e,a.precision));d.setAttribute("d",g);d.setAttribute("stroke-opacity",this._options.style.strokeOpacity);d.setAttribute("stroke-linejoin","round")};g.onmouseover=function(d){if("mapcurve"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&r(b,d,"Click to select");if(!a.touchdevices&&"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id].link&&
(this.style.cursor="pointer"),"onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id].infobox&&!document.getElementById("imap5custom_"+b.usermap+"_infobox_mapcurve_"+this._id))){var c={};c.clientX=d.clientX;c.clientY=d.clientY;c.obj="mapcurve";c.infobox=a.usermap[b.usermap].map.mapcurve[this._id].infobox;this.infobox=new u(b,this._id,c)}};g.onmouseout=function(d){if("mapcurve"==
a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&v(b);"normal"==a.mode[b.usermap]&&(this.style.cursor="auto","onmouseover"==a.usermap[b.usermap].infobox.show&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id].infobox&&(null==d.relatedTarget||d.relatedTarget.id!="imap5custom_"+b.usermap+"_infobox_mapcurve_"+this._id)&&document.getElementById("imap5custom_"+b.usermap+"_infobox_mapcurve_"+
this._id)&&this.infobox.remove())};g.onmousemove=function(d){d.preventDefault&&d.preventDefault();"normal"==a.mode[b.usermap]&&(a.div[b.usermap]._mousedown?document.getElementById("imap5custom_"+b.usermap+"_infobox_mapcurve_"+this._id)&&this.infobox.hide():document.getElementById("imap5custom_"+b.usermap+"_infobox_mapcurve_"+this._id)&&(this.infobox.reposition(d.clientX,d.clientY),this.infobox.show()))};g.onclick=function(d){this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||("edit"==
a.mode[b.usermap]?(this.createVertices(),d={event:"click",object:"mapcurve"},d.id=Number(this._id),window.console&&console.log(JSON.stringify(d))):"normal"==a.mode[b.usermap]&&("undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id].link)&&("undefined"==typeof a.usermap[b.usermap].map.mapcurve[this._id].link_target?location.href=a.usermap[b.usermap].map.mapcurve[this._id].link:window.open(a.usermap[b.usermap].map.mapcurve[this._id].link,
a.usermap[b.usermap].map.mapcurve[this._id].link_target)))};a.touchdevices&&(g.ontouchstart=function(a){1==a.touches.length&&(this._touch=!0,this._move=!1,this._posX=a.touches[0].clientX,this._posY=a.touches[0].clientY)},g.ontouchmove=function(a){1==a.touches.length?this._touch&&(10<Math.abs(a.touches[0].clientX-this._posX)||10<Math.abs(a.touches[0].clientY-this._posY))&&(this._move=!0):this._touch=!1},g.ontouchend=function(c){if(this._touch&&!this._move&&!a.div[b.usermap]._mapdragged){if("edit"==
a.mode[b.usermap]){c={event:"click",object:"mapcurve"};c.id=this._id;window.console&&console.log(JSON.stringify(c));return}"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id]&&"undefined"!=typeof a.usermap[b.usermap].map.mapcurve[this._id].link&&("undefined"==typeof a.usermap[b.usermap].map.mapcurve[this._id].link_target?location.href=a.usermap[b.usermap].map.mapcurve[this._id].link:window.open(a.usermap[b.usermap].map.mapcurve[this._id].link,a.usermap[b.usermap].map.mapcurve[this._id].link_target));
if("edit"==a.mode[b.usermap])return;0<a.infobox[b.usermap].length&&(document.getElementById("imap5custom_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)&&a.div[b.usermap].removeChild(document.getElementById("imap5custom_"+b.usermap+"_infobox_"+a.infobox[b.usermap][0].object+"_"+a.infobox[b.usermap][0].id)),a.infobox[b.usermap].pop());"undefined"==typeof a.usermap[b.usermap].map.mapcurve[this._id]||("undefined"==typeof a.usermap[b.usermap].map.mapcurve[this._id].infobox||
document.getElementById("imap5custom_"+b.usermap+"_infobox_mapcurve_"+this._id))||(c={},c.clientX=this._posX,c.clientY=this._posY,c.obj="mapcurve",c.infobox=a.usermap[b.usermap].map.mapcurve[this._id].infobox,this.infobox=new u(b,this._id,c))}this._move=this._touch=!1});g.remove=function(){for(var c in this._mainvertices)this._mainvertices.hasOwnProperty(c)&&this._mainvertices[c].remove();a.g[b.usermap].removeChild(this);a.mapcurve[b.usermap][this._id]=null};g.drawMapCurve();return g},y=function(b,
f,h,c){var g=this,d=a.usermap[b.usermap].map.id,n=p("g");a.g[b.usermap].appendChild(n);n._options=c;n._id=f;0==c.type?n.setAttribute("id","imap5custom_"+b.usermap+"_verticesobj_"+f):n.setAttribute("id","imap5custom_"+b.usermap+"_subverticesobj_"+f);n._lat=c.lat;n._lng=c.lng;n._type=c.type;n._removable=c.removeable;this._parentnode=h;n._dx=n._lng*(a.map[d].precision/a.factor[b.usermap]);n._dy=parseFloat(n._lat)*(a.map[d].precision/a.factor[b.usermap]);n.setOptions=function(a){this._options=a;this._lat=
a.lat;this._lng=a.lng;this._type=a.type;this._removable=a.removable};n.hide=function(){this.style.visibility="hidden"};n.show=function(){this.style.visibility="visible"};n.onmouseover=function(d){"edit"==a.mode[b.usermap]&&(this.style.cursor="pointer");"edit"==a.mode[b.usermap]&&(0==c.type?c.removable?r(b,d,"<strong>[Drag]</strong> to change position. <strong>[Right Click]</strong> to delete."):r(b,d,"<strong>[Drag]</strong> to change position."):r(b,d,"<strong>[Click]</strong> to split the line segment"))};
n.onmouseout=function(c){"edit"==a.mode[b.usermap]&&(this.style.cursor="auto");"edit"==a.mode[b.usermap]&&v(b);"normal"==a.mode[b.usermap]&&(this.style.cursor="auto")};n.onmousedown=function(d){d.preventDefault&&d.preventDefault();"edit"==a.mode[b.usermap]&&(d.stopPropagation&&d.stopPropagation(),this._mousedown=!0,this._mapdragged=!1,this._x=d.clientX,this._y=d.clientY,0==c.type?(a.selectedOverlay[b.usermap]=this,g._parentnode.hideSubVertices()):g._parentnode.addVertices(f,this._options.lat,this._options.lng))};
0==c.type&&(n.onmousemove=function(h){h.preventDefault&&h.preventDefault();if("edit"==a.mode[b.usermap]&&(h.stopPropagation&&h.stopPropagation(),this._mousedown&&0==c.type&&(2<Math.abs(h.clientX-this._x)||2<Math.abs(h.clientY-this._y)))){this._mapdragged=!0;this._x=h.clientX;this._y=h.clientY;var e=a.svgcoord[b.usermap];e.x=h.clientX;e.y=h.clientY;e=s(e,a.g[b.usermap]);e.x/=a.map[d].precision/a.factor[b.usermap];e.y/=a.map[d].precision/a.factor[b.usermap];h=e.x;var n=e.y;this._lat=e.y*(a.map[d].precision/
a.factor[b.usermap]);this._lng=e.x*(a.map[d].precision/a.factor[b.usermap]);this.setAttribute("transform","translate("+k(this._lng,a.precision)+","+k(this._lat,a.precision)+") scale("+k(a.map[d].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")");g._parentnode.updateVertices(f,n,h)}},n.onmouseup=function(d){d.preventDefault&&d.preventDefault();"edit"==a.mode[b.usermap]&&0==c.type&&(d.stopPropagation&&d.stopPropagation(),a.selectedOverlay[b.usermap]==this&&(a.selectedOverlay[b.usermap]=
null),g._parentnode.postPosChange(),this._mousedown=!1)},n.oncontextmenu=function(d){d.preventDefault&&d.preventDefault();"edit"==a.mode[b.usermap]&&(d.stopPropagation&&d.stopPropagation(),0==c.type&&c.removable&&g._parentnode.removeVertices(f))});n.drawVerticesObj=function(){var c=this.getElementsByTagName("g")[0];"undefined"!=typeof c&&this.removeChild(c);var c=p("g"),e=p("circle");c.appendChild(e);this.appendChild(c);e.setAttribute("cx",0);e.setAttribute("cy",0);e.setAttribute("r",5);e.setAttribute("stroke",
"#000000");e.setAttribute("stroke-width",1);1==this._type?(e.setAttribute("fill","#CCCCCC"),e.setAttribute("fill-opacity",0.5)):(e.setAttribute("fill","#FFFFFF"),e.setAttribute("fill-opacity",1));c.setAttribute("transform","scale(1,-1)");c=this._options.lat;e=this._options.lng;this._lat=c*(a.map[d].precision/a.factor[b.usermap]);this._lng=e*(a.map[d].precision/a.factor[b.usermap]);this.setAttribute("transform","translate("+k(e*(a.map[d].precision/a.factor[b.usermap]),a.precision)+","+k(c*(a.map[d].precision/
a.factor[b.usermap]),a.precision)+") scale("+k(a.map[d].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};n.rescale=function(){this.setAttribute("transform","translate("+k(this._lng,a.precision)+","+k(this._lat,a.precision)+") scale("+k(a.map[d].precision/a.factor[b.usermap]/a.zoom[b.usermap].currentzoom,a.precision)+")")};n.remove=function(){a.g[b.usermap].removeChild(this)};n.drawVerticesObj();return n},u=function(b,f,h){var c=document.createElement("div");c.id="imap5custom_"+
b.usermap+"_infobox_"+h.obj+"_"+f;c.options=h;c.style.position="fixed";c.style.top=h.clientY+3+"px";c.style.left=h.clientX+3+"px";for(var g in a.usermap[b.usermap].infobox.style)"backgroundColor"!=g&&"opacity"!=g&&(c.style[g]=a.usermap[b.usermap].infobox.style[g]);c.style.backgroundColor="rgba("+ +parseInt(w(a.usermap[b.usermap].infobox.style.backgroundColor).substring(0,2),16)+","+parseInt(w(a.usermap[b.usermap].infobox.style.backgroundColor).substring(2,4),16)+","+parseInt(w(a.usermap[b.usermap].infobox.style.backgroundColor).substring(4,
6),16)+","+a.usermap[b.usermap].infobox.style.opacity+")";c.innerHTML=h.infobox;a.div[b.usermap].appendChild(c);c.onmouseout=function(a){for(var b=a.relatedTarget;null!=b;){if(b==this)return;b=b.parentNode}null!=a.relatedTarget&&this.id.split("_")[4]!=a.relatedTarget.parentNode.id&&this.remove()};c.onmouseup=function(a){a.stopPropagation&&a.stopPropagation()};c.onmousedown=function(a){a.stopPropagation&&a.stopPropagation()};c.onmousewheel=function(a){a.stopPropagation&&a.stopPropagation()};a.div[b.usermap].addEventListener&&
c.addEventListener("DOMMouseScroll",function(a){a.stopPropagation&&a.stopPropagation()},!1);c.show=function(){this.style.display="block"};c.hide=function(){this.style.display="none"};c.reposition=function(c,g){var f;f="undefined"!=typeof a.usermap[b.usermap].infobox.style.sensitivity?a.usermap[b.usermap].infobox.style.sensitivity:15;Math.sqrt((this.options.clientX-c)*(this.options.clientX-c)+(this.options.clientY-g)*(this.options.clientY-g))>f&&(this.options.clientX=c,this.options.clientY=g,c>document.body.offsetWidth/
2?"undefined"!=typeof a.usermap[b.usermap].infobox.style.width?this.style.left=c-this.offsetWidth+"px":(f=Math.min(c,parseFloat(window.getComputedStyle(document.getElementById(this.id),null).getPropertyValue("width"))),this.style.width=f+"px",this.style.left=c-f-3-2*parseInt(a.usermap[b.usermap].infobox.style.padding)+"px"):("undefined"==typeof a.usermap[b.usermap].infobox.style.width&&(this.style.width="auto"),this.style.left=c+3+"px"),this.style.top=g+3+"px")};c.remove=function(){a.div[b.usermap].removeChild(document.getElementById(this.id));
a.infobox[b.usermap].pop()};a.touchdevices&&(c.ontouchstart=c.ontouchmove=c.ontouchend=function(a){a.stopPropagation&&a.stopPropagation()});g={};g.object=h.obj;g.id=f;a.infobox[b.usermap].push(g);c.reposition(h.clientX,h.clientY);return c},M=function(b,f,h){var c=document.createElement("div");c.id="imap5custom_"+b.usermap+"_maplegend_"+f;c.options=h;c.style.position="fixed";c._show=!0;a.div[b.usermap].appendChild(c);c.setOptions=function(a){this.options=a};c.hide=function(){this.style.display="none";
this._show=!1};c.show=function(){this.style.display="block";this._show=!0};c.toggleCategory=function(){"normal"==a.mode[b.usermap]?"undefined"!=typeof a.usermap[b.usermap].map.categorylegend&&a.usermap[b.usermap].map.categorylegend.enable?0!=this.options.categoryid&&("undefined"!=typeof a.categorylegend[b.usermap]?-1!=a.categorylegend[b.usermap].visiblelist.indexOf(this.options.categoryid)?this.show():this.hide():this.show()):this.show():this.show()};c.drawMapLegend=function(){if(this.hasChildNodes())for(;1<=
this.childNodes.length;)this.removeChild(this.firstChild);for(var c in h.style)"backgroundColor"!=c&&"opacity"!=c&&(this.style[c]=this.options.style[c]);this.style.backgroundColor="rgba("+ +parseInt(w(this.options.style.backgroundColor).substring(0,2),16)+","+parseInt(w(this.options.style.backgroundColor).substring(2,4),16)+","+parseInt(w(this.options.style.backgroundColor).substring(4,6),16)+","+this.options.style.opacity+")";var d=0,f=this.options.columnsPerRow,k=parseInt(this.options.columnWidth)*
f,e=parseInt(this.options.columnWidth)*f-6,p=parseInt(this.options.icon.width),q=parseInt(this.options.icon.height),r=parseInt(this.options.columnWidth)-(p+6)-6,s=parseInt(this.options.columnWidth),m=new z;m.style.width=k+"px";this.appendChild(m);for(c in this.options.items)if(this.options.items.hasOwnProperty(c)){switch(this.options.items[c].type){case 1:m={};m.text=this.options.items[c].text;m.width=e;m.fontFamily=this.options.style.fontFamily;m.fontSize=this.options.style.fontSize;m.fontColor=
this.options.style.fontColor;d=new S(m);this.appendChild(d);d=0;break;case 2:m={};m.text=this.options.items[c].text;m.image=this.options.items[c].image;m.basepath=a.base[b.usermap];m.iconWidth=p;m.iconHeight=q;m.legendTextWidth=r;m.width=s;m.fontFamily=this.options.style.fontFamily;m.fontSize=this.options.style.fontSize;m.fontColor=this.options.style.fontColor;m.columnsPerRow=this.options.columnsPerRow;m=new V(m);this.appendChild(m);d+=1;break;case 3:m={};m.text=this.options.items[c].text;m.fill=
this.options.items[c].fill;m.iconWidth=p;m.iconHeight=q;m.legendTextWidth=r;m.width=s;m.fontFamily=this.options.style.fontFamily;m.fontSize=this.options.style.fontSize;m.fontColor=this.options.style.fontColor;m.columnsPerRow=this.options.columnsPerRow;m=new W(m);this.appendChild(m);d+=1;break;case 4:m={},m.text=this.options.items[c].text,m.stroke=this.options.items[c].stroke,m.iconWidth=p,m.iconHeight=q,m.legendTextWidth=r,m.width=s,m.fontFamily=this.options.style.fontFamily,m.fontSize=this.options.style.fontSize,
m.fontColor=this.options.style.fontColor,m.columnsPerRow=this.options.columnsPerRow,m=new X(m),this.appendChild(m),d+=1}if(d==f||"1"==this.options.items[c].type)m=new z,m.style.width=k+"px",this.appendChild(m),d=0}this.style.position="absolute";this.style.display="table";this.style.width=k+"px";switch(this.options.anchor){case 1:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.bottom=
"auto";this.style.right="auto";break;case 2:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.width)-parseInt(this.offsetWidth))/2+"px";this.style.bottom="auto";this.style.right="auto";break;case 3:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.bottom=
"auto";this.style.left="auto";break;case 4:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.height)-parseInt(this.offsetHeight))/2+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.bottom="auto";this.style.right="auto";break;case 5:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.height)-parseInt(this.offsetHeight))/2+"px";this.style.left=
parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.width)-parseInt(this.offsetWidth))/2+"px";this.style.bottom="auto";this.style.right="auto";break;case 6:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.height)-parseInt(this.offsetHeight))/2+"px";this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.bottom="auto";this.style.left="auto";break;case 7:this.style.bottom=
10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.top="auto";this.style.right="auto";break;case 8:this.style.bottom=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.width)-parseInt(this.offsetWidth))/2+"px";this.style.top="auto";this.style.right="auto";break;case 9:this.style.bottom=
10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.top="auto";this.style.left="auto";break;default:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px",this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px",this.style.bottom="auto",this.style.left="auto"}};c.remove=function(){a.div[b.usermap].removeChild(document.getElementById(this.id))};c.onmouseup=function(a){};
c.onmousedown=function(a){};c.onmouseover=function(c){if("maplegend"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="pointer";"edit"==a.mode[b.usermap]&&r(b,c,"Click to select")};c.onmouseout=function(c){if("maplegend"==a.mode[b.usermap]||"edit"==a.mode[b.usermap])this.style.cursor="auto";"edit"==a.mode[b.usermap]&&v(b)};c.onmousewheel=function(a){};a.div[b.usermap].addEventListener&&c.addEventListener("DOMMouseScroll",function(a){},!1);c.onclick=function(c){c.stopPropagation&&c.stopPropagation();
this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||"edit"!=a.mode[b.usermap]||(c={event:"click",object:"maplegend"},c.id=Number(f),window.console&&console.log(JSON.stringify(c)))};a.touchdevices&&(c.ontouchstart=c.ontouchmove=c.ontouchend=function(a){a.stopPropagation&&a.stopPropagation()});c.drawMapLegend();return c},S=function(a){var f=document.createElement("div");f.style.cssFloat="left";f.style.overflow="hidden";f.style.textOverflow="ellipsis";f.style.whiteSpace="nowrap";f.style.padding=
"3px";f.style.fontFamily=a.fontFamily;f.style.fontSize=a.fontSize;f.style.color=a.fontColor;f.style.width=a.width+"px";f.style.fontWeight="bold";f.innerHTML=a.text;return f},A=function(a){var f=document.createElement("div");f.style.cssFloat="left";f.style.overflow="hidden";f.style.textOverflow="ellipsis";f.style.whiteSpace="nowrap";f.style.width=a.width+"px";f.style.padding="3px";f.style.fontFamily=a.fontFamily;f.style.fontSize=a.fontSize;f.style.color=a.fontColor;f.style.border="0px";f.innerHTML=
a.text;return f},V=function(a){var f=document.createElement("div"),h=document.createElement("div");h.style.cssFloat="left";h.style.padding="3px";h.style.width=a.iconWidth+"px";h.style.height=a.iconHeight+"px";var c=document.createElement("img");c.setAttribute("src",a.basepath+a.image);c.setAttribute("width",a.iconWidth+"px");c.setAttribute("height",a.iconHeight+"px");h.appendChild(c);c={};c.width=a.legendTextWidth;c.fontFamily=a.fontFamily;c.fontSize=a.fontSize;c.fontColor=a.fontColor;c.text=a.text;
var c=new A(c),g=new z;f.style.width=a.width+"px";f.style.height="auto";f.style.cssFloat="left";f.style.padding="0px";f.appendChild(h);f.appendChild(c);f.appendChild(g);return f},W=function(a){var f=document.createElement("div"),h=document.createElement("div");h.style.cssFloat="left";h.style.margin="3px";h.style.width=a.iconWidth+"px";h.style.height=a.iconHeight+"px";h.style.backgroundColor=a.fill;var c={};c.width=a.legendTextWidth;c.fontFamily=a.fontFamily;c.fontSize=a.fontSize;c.fontColor=a.fontColor;
c.text=a.text;var c=new A(c),g=new z;f.style.width=a.width+"px";f.style.height="auto";f.style.cssFloat="left";f.style.padding="0px";f.appendChild(h);f.appendChild(c);f.appendChild(g);return f},X=function(a){var f=document.createElement("div"),h=document.createElement("div");h.style.cssFloat="left";h.style.padding="3px";h.style.width=a.iconWidth+"px";h.style.height=a.iconHeight+"px";h.style.backgroundColor=a.fill;var c=p("svg");c.setAttribute("xmlns","http://www.w3.org/2000/svg");c.setAttribute("xmlns:xlink",
"http://www.w3.org/1999/xlink");c.setAttribute("version","1.1");c.setAttribute("width",a.iconWidth+"px");c.setAttribute("height",a.iconHeight+"px");c.style.overflow="hidden";var g=p("polyline");g.setAttribute("points","1,"+a.iconHeight/2+" "+(a.iconWidth-1)+","+a.iconHeight/2);g.style.fill="none";g.style.stroke=a.stroke;g.style.strokeWidth=2;c.appendChild(g);h.appendChild(c);c={};c.width=a.legendTextWidth;c.fontFamily=a.fontFamily;c.fontSize=a.fontSize;c.fontColor=a.fontColor;c.text=a.text;c=new A(c);
g=new z;g.style.width=a.width+"px";f.style.width=a.width+"px";f.style.height="auto";f.style.cssFloat="left";f.style.padding="0px";f.appendChild(h);f.appendChild(c);f.appendChild(g);return f},z=function(){var a=document.createElement("div");a.style.clear="both";return a},Y=function(b){var f={};f.width=b.legendTextWidth;f.fontFamily=b.fontFamily;f.fontSize=b.fontSize;f.fontColor=b.fontColor;f.text=b.text;f=new A(f);f.style.cursor="pointer";a.touchdevices||(f.onmouseover=function(){imap5custom.categorylegend[b.usermap].visiblelist.length=
0;imap5custom.categorylegend[b.usermap].visiblelist.push(b.categoryid);var a={};a.usermap=b.usermap;imap5custom.updateCategoryLegend(a);this.style.textDecoration="underline"},f.onmouseout=function(){this.style.textDecoration="none"});a.touchdevices&&(f.onclick=function(){"undefined"!==typeof imap5custom.categorylegend[b.usermap].touchlist&&null!==imap5custom.categorylegend[b.usermap].touchlist&&"undefined"!==typeof imap5custom.categorylegend[b.usermap].touchlist.style&&(imap5custom.categorylegend[b.usermap].touchlist.style.textDecoration=
"none");imap5custom.categorylegend[b.usermap].visiblelist.length=0;imap5custom.categorylegend[b.usermap].visiblelist.push(b.categoryid);imap5custom.categorylegend[b.usermap].touchlist=this;this.style.textDecoration="underline";var a={};a.usermap=b.usermap;imap5custom.updateCategoryLegend(a)});a.touchdevices&&(f.ontouchstart=function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();this._touch=1==a.touches.length?!0:!1});a.touchdevices&&(f.ontouchend=function(a){this._touch&&
(a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),"undefined"!==typeof imap5custom.categorylegend[b.usermap].touchlist&&null!==imap5custom.categorylegend[b.usermap].touchlist&&"undefined"!==typeof imap5custom.categorylegend[b.usermap].touchlist.style&&(imap5custom.categorylegend[b.usermap].touchlist.style.textDecoration="none"),imap5custom.categorylegend[b.usermap].visiblelist.length=0,imap5custom.categorylegend[b.usermap].visiblelist.push(b.categoryid),imap5custom.categorylegend[b.usermap].touchlist=
this,this.style.textDecoration="underline",a={},a.usermap=b.usermap,imap5custom.updateCategoryLegend(a))});return f},Z=function(b){var f=document.createElement("div"),h=document.createElement("div");h.style.cssFloat="left";h.style.width="16px";h.style.height="16px";var c=document.createElement("input");c.setAttribute("type","checkbox");c.checked=b.checked;c.setAttribute("width","16px");c.setAttribute("height","16px");h.appendChild(c);c.onclick=function(a){this.checked?imap5custom.categorylegend[b.usermap].visiblelist.push(b.categoryid):
(a=imap5custom.categorylegend[b.usermap].visiblelist.indexOf(b.categoryid),imap5custom.categorylegend[b.usermap].visiblelist.splice(a,1));a={};a.usermap=b.usermap;imap5custom.updateCategoryLegend(a)};var g={};g.width=b.legendTextWidth;g.fontFamily=b.fontFamily;g.fontSize=b.fontSize;g.fontColor=b.fontColor;g.text=b.text;g=new A(g);g.checkbox=c;g.onclick=function(){this.checkbox.checked=!this.checkbox.checked;if(this.checkbox.checked)imap5custom.categorylegend[b.usermap].visiblelist.push(b.categoryid);
else{var a=imap5custom.categorylegend[b.usermap].visiblelist.indexOf(b.categoryid);imap5custom.categorylegend[b.usermap].visiblelist.splice(a,1)}a={};a.usermap=b.usermap;imap5custom.updateCategoryLegend(a)};a.touchdevices&&(g.ontouchstart=function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();this._touch=1==a.touches.length?!0:!1});a.touchdevices&&(g.ontouchend=function(a){this._touch&&(this.checkbox.checked=!this.checkbox.checked,this.checkbox.checked?imap5custom.categorylegend[b.usermap].visiblelist.push(b.categoryid):
(a=imap5custom.categorylegend[b.usermap].visiblelist.indexOf(b.categoryid),imap5custom.categorylegend[b.usermap].visiblelist.splice(a,1)),a={},a.usermap=b.usermap,imap5custom.updateCategoryLegend(a))});g.style.cursor="pointer";c=new z;f.style.width=b.width+"px";f.style.height="auto";f.style.cssFloat="left";f.style.padding="0px";f.appendChild(h);f.appendChild(g);f.appendChild(c);return f},J=function(b,f){var h=p("g");h.id="imap5custom_"+b.usermap+"_maptitle";h.options=f;h._show=!0;a.svg[b.usermap].appendChild(h);
h.setOptions=function(a){this.options=a};h.hide=function(){this.style.display="none";this._show=!1};h.show=function(){this.style.display="block";this._show=!0};h.remove=function(){a.svg[b.usermap].removeChild(this)};h.drawMapTitle=function(){var c=this.getElementsByTagName("text")[0];"undefined"!=typeof c&&this.removeChild(c);c=p("text");c.appendChild(document.createTextNode(this.options.text));c.style.cursor="default";c.setAttribute("style","stroke-width:0");c.style.strokeOpacity=0;c.style.fontFamily=
this.options.style.fontFamily;c.style.fill=this.options.style.fontColor;c.style.fontSize=this.options.style.fontSize;c.style.fontStyle=this.options.style.fontStyle;c.style.fontWeight=this.options.style.fontWeight;c.style.pointerEvents="none";this.appendChild(c);c.setAttribute("x",-4096);c.setAttribute("y",-4096);c.setAttribute("text-anchor","middle");switch(this.options.anchor){case 1:c.setAttribute("text-anchor","start");c.setAttribute("x",0);c.setAttribute("y",parseInt(c.style.fontSize));break;
case 2:c.setAttribute("text-anchor","middle");c.setAttribute("x",a.div[b.usermap].clientWidth/2);c.setAttribute("y",parseInt(c.style.fontSize));break;case 3:c.setAttribute("text-anchor","end");c.setAttribute("x",a.div[b.usermap].clientWidth);c.setAttribute("y",parseInt(c.style.fontSize));break;case 4:c.setAttribute("text-anchor","start");c.setAttribute("x",0);c.setAttribute("y",a.div[b.usermap].clientHeight/2+parseInt(c.style.fontSize)/2);break;case 5:c.setAttribute("text-anchor","middle");c.setAttribute("x",
a.div[b.usermap].clientWidth/2);c.setAttribute("y",a.div[b.usermap].clientHeight/2+parseInt(c.style.fontSize)/2);break;case 6:c.setAttribute("text-anchor","end");c.setAttribute("x",a.div[b.usermap].clientWidth);c.setAttribute("y",a.div[b.usermap].clientHeight/2+parseInt(c.style.fontSize)/2);break;case 7:c.setAttribute("text-anchor","start");c.setAttribute("x",0);c.setAttribute("y",a.div[b.usermap].clientHeight-5);break;case 8:c.setAttribute("text-anchor","middle");c.setAttribute("x",a.div[b.usermap].clientWidth/
2);c.setAttribute("y",a.div[b.usermap].clientHeight-5);break;case 9:c.setAttribute("text-anchor","end");c.setAttribute("x",a.div[b.usermap].clientWidth);c.setAttribute("y",a.div[b.usermap].clientHeight-5);break;default:c.setAttribute("text-anchor","middle"),c.setAttribute("x",a.div[b.usermap].clientWidth/2),c.setAttribute("y",parseInt(c.style.fontSize))}};h.drawMapTitle();return h},I=function(b,f){var h=document.createElement("div");h.id="imap5custom_"+b.usermap+"_categorylegend";h.options=f;h.style.position=
"fixed";h._show=!0;a.div[b.usermap].appendChild(h);h.setOptions=function(a){this.options=a};h.hide=function(){this.style.display="none";this._show=!1};h.show=function(){this.style.display="block";this._show=!0};h.remove=function(){a.div[b.usermap].removeChild(document.getElementById(this.id))};h.drawCategoryLegend=function(){this.visiblelist=[];this.touchlist={};if(this.hasChildNodes())for(;1<=this.childNodes.length;)this.removeChild(this.firstChild);for(var c in f.style)"backgroundColor"!=c&&"opacity"!=
c&&(this.style[c]=this.options.style[c]);this.style.backgroundColor="rgba("+ +parseInt(w(this.options.style.backgroundColor).substring(0,2),16)+","+parseInt(w(this.options.style.backgroundColor).substring(2,4),16)+","+parseInt(w(this.options.style.backgroundColor).substring(4,6),16)+","+this.options.style.opacity+")";var g=0,d=this.options.columnsPerRow,h=parseInt(this.options.columnWidth)*d,k=parseInt(this.options.columnWidth)*d-6,e=parseInt(this.options.columnWidth)-22-6,p=parseInt(this.options.columnWidth),
q=new z;q.style.width=h+"px";this.appendChild(q);for(c in this.options.items)if(this.options.items.hasOwnProperty(c)){switch(this.options.items[c].type){case 1:q={};q.text=this.options.items[c].text;q.width=k;q.fontFamily=this.options.style.fontFamily;q.fontSize=this.options.style.fontSize;q.fontColor=this.options.style.fontColor;g=new S(q);this.appendChild(g);g=0;break;case 2:0==this.options.mode?(q={},q.text=this.options.items[c].text,q.categoryid=this.options.items[c].categoryid,q.checked=this.options.items[c].checked,
this.options.items[c].checked&&-1==this.visiblelist.indexOf(this.options.items[c].categoryid)&&this.visiblelist.push(this.options.items[c].categoryid),q.usermap=b.usermap,q.legendTextWidth=e,q.width=p,q.fontFamily=this.options.style.fontFamily,q.fontSize=this.options.style.fontSize,q.fontColor=this.options.style.fontColor,q.columnsPerRow=this.options.columnsPerRow,q=new Z(q)):(q={},q.text=this.options.items[c].text,q.categoryid=this.options.items[c].categoryid,q.usermap=b.usermap,q.legendTextWidth=
e+22,q.width=p,q.fontFamily=this.options.style.fontFamily,q.fontSize=this.options.style.fontSize,q.fontColor=this.options.style.fontColor,q.columnsPerRow=this.options.columnsPerRow,q=new Y(q)),this.appendChild(q),g+=1}if(g==d||"1"==this.options.items[c].type)q=new z,q.style.width=h+"px",this.appendChild(q),g=0}this.style.position="absolute";this.style.display="table";this.style.width=h+"px";switch(this.options.anchor){case 1:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";
this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.bottom="auto";this.style.right="auto";break;case 2:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.width)-parseInt(this.offsetWidth))/2+"px";this.style.bottom="auto";this.style.right="auto";break;case 3:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";
this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.bottom="auto";this.style.left="auto";break;case 4:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.height)-parseInt(this.offsetHeight))/2+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.bottom="auto";this.style.right="auto";break;case 5:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.height)-
parseInt(this.offsetHeight))/2+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.width)-parseInt(this.offsetWidth))/2+"px";this.style.bottom="auto";this.style.right="auto";break;case 6:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.height)-parseInt(this.offsetHeight))/2+"px";this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.bottom="auto";
this.style.left="auto";break;case 7:this.style.bottom=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px";this.style.top="auto";this.style.right="auto";break;case 8:this.style.bottom=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.left=parseInt(a.usermap[b.usermap].div.style.borderWidth)+(parseInt(a.usermap[b.usermap].div.style.width)-parseInt(this.offsetWidth))/2+"px";this.style.top="auto";
this.style.right="auto";break;case 9:this.style.bottom=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px";this.style.top="auto";this.style.left="auto";break;default:this.style.top=parseInt(a.usermap[b.usermap].div.style.borderWidth)+10+"px",this.style.right=10-parseInt(a.usermap[b.usermap].div.style.borderWidth)+"px",this.style.bottom="auto",this.style.left="auto"}};h.onmouseup=function(a){};h.onmousedown=function(a){};
h.onmouseover=function(c){"edit"==a.mode[b.usermap]&&(this.style.cursor="pointer");"edit"==a.mode[b.usermap]&&r(b,c,"Click to select")};h.onmouseout=function(c){"edit"==a.mode[b.usermap]&&(this.style.cursor="auto");"edit"==a.mode[b.usermap]&&v(b)};h.onmousewheel=function(a){};a.div[b.usermap].addEventListener&&h.addEventListener("DOMMouseScroll",function(a){},!1);h.onclick=function(c){c.stopPropagation&&c.stopPropagation();this._mapdragged||this._transformed||a.div[b.usermap]._mapdragged||"edit"!=
a.mode[b.usermap]||(c={event:"click",object:"categorylegend"},window.console&&console.log(JSON.stringify(c)))};a.touchdevices&&(h.ontouchstart=h.ontouchmove=h.ontouchend=function(a){a.stopPropagation&&a.stopPropagation()});h.drawCategoryLegend();return h}}})();